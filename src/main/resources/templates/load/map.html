<html layout:decorate="~{layout}">
<div layout:fragment="content" class="container">
	<link rel="stylesheet" href="/css/map.css" />

	<div class="selectRegion my-2">
		<h2 class="my-3">ì§€ì—­ì„ ì„ íƒí•´ì£¼ì„¸ìš”</h2>
		<form class="selectRegionForm">
			<label for="city">ì‹œ/ë„ ì„ íƒ:</label>
			<select id="city">
				<option value="">ì„ íƒí•˜ì„¸ìš”</option>
				<option value="ì„œìš¸">ì„œìš¸</option>
				<option value="ë¶€ì‚°">ë¶€ì‚°</option>
				<option value="ëŒ€êµ¬">ëŒ€êµ¬</option>
				<option value="ì¸ì²œ">ì¸ì²œ</option>
				<option value="ê´‘ì£¼">ê´‘ì£¼</option>
				<option value="ëŒ€ì „">ëŒ€ì „</option>
				<option value="ìš¸ì‚°">ìš¸ì‚°</option>
				<option value="ì„¸ì¢…">ì„¸ì¢…</option>
				<option value="ê²½ê¸°">ê²½ê¸°</option>
				<option value="ê°•ì›">ê°•ì›</option>
				<option value="ì¶©ë¶">ì¶©ë¶</option>
				<option value="ì¶©ë‚¨">ì¶©ë‚¨</option>
				<option value="ì „ë¶">ì „ë¶</option>
				<option value="ì „ë‚¨">ì „ë‚¨</option>
				<option value="ê²½ë¶">ê²½ë¶</option>
				<option value="ê²½ë‚¨">ê²½ë‚¨</option>
				<option value="ì œì£¼">ì œì£¼</option>
			</select>

			<label for="district">êµ¬ ì„ íƒ:</label>
			<select id="district" disabled>
				<option value="">ì‹œ/ë„ë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
			</select>
			<span title="í˜„ì¬ ìœ„ì¹˜" class="getUserLocationBtn"><img
					src="/imgs/map/my_location_30dp_5F6368_FILL0_wght400_GRAD0_opsz24.svg" alt="" /></span>
		</form>
	</div>
	<div class="container mapWrapper">
		<div id="restaurantList"></div>
		<div id="pagination"></div>
		<div id="map"></div>
	</div>
	<script>
		const districts = {
			ì„œìš¸: {
				coords: {lat: 37.5665, lng: 126.978},
				districts: {
					"ê°•ë‚¨êµ¬": {coords: {lat: 37.5172, lng: 127.0473}},
					"ê°•ë™êµ¬": {coords: {lat: 37.5303, lng: 127.1238}},
					"ê°•ë¶êµ¬": {coords: {lat: 37.6398, lng: 127.0255}},
					"ê´€ì•…êµ¬": {coords: {lat: 37.4783, lng: 126.9512}},
					"êµ¬ë¡œêµ¬": {coords: {lat: 37.4955, lng: 126.8832}},
					"ê¸ˆì²œêµ¬": {coords: {lat: 37.4545, lng: 126.9005}},
					"ë…¸ì›êµ¬": {coords: {lat: 37.6550, lng: 127.0565}},
					"ë„ë´‰êµ¬": {coords: {lat: 37.6684, lng: 127.0288}},
					"ë™ëŒ€ë¬¸êµ¬": {coords: {lat: 37.5744, lng: 127.0422}},
					"ë™ì‘êµ¬": {coords: {lat: 37.5045, lng: 126.9515}},
					"ë§ˆí¬êµ¬": {coords: {lat: 37.5482, lng: 126.9033}},
					"ì„œëŒ€ë¬¸êµ¬": {coords: {lat: 37.5793, lng: 126.9655}},
					"ì„œì´ˆêµ¬": {coords: {lat: 37.4839, lng: 127.0324}},
					"ì„±ë™êµ¬": {coords: {lat: 37.5636, lng: 127.0428}},
					"ì„±ë¶êµ¬": {coords: {lat: 37.5890, lng: 127.0170}},
					"ì†¡íŒŒêµ¬": {coords: {lat: 37.5049, lng: 127.1149}},
					"ì–‘ì²œêµ¬": {coords: {lat: 37.5162, lng: 126.8660}},
					"ì˜ë“±í¬êµ¬": {coords: {lat: 37.5260, lng: 126.8958}},
					"ìš©ì‚°êµ¬": {coords: {lat: 37.5326, lng: 126.9905}},
					"ì€í‰êµ¬": {coords: {lat: 37.6090, lng: 126.9345}},
					"ì¢…ë¡œêµ¬": {coords: {lat: 37.5700, lng: 126.9980}},
					"ì¤‘êµ¬": {coords: {lat: 37.5636, lng: 126.9970}},
					"ì¤‘ë‘êµ¬": {coords: {lat: 37.6060, lng: 127.0920}}
				}
			},
			ë¶€ì‚°: {
				coords: {lat: 35.1796, lng: 129.0756},
				districts: {
					"ê°•ì„œêµ¬": {coords: {lat: 35.1744, lng: 128.9470}},
					"ê¸ˆì •êµ¬": {coords: {lat: 35.2280, lng: 129.0790}},
					"ê¸°ì¥êµ°": {coords: {lat: 35.2390, lng: 129.2270}},
					"ë‚¨êµ¬": {coords: {lat: 35.1460, lng: 129.1000}},
					"ë™êµ¬": {coords: {lat: 35.0660, lng: 129.0400}},
					"ë¶€ì‚°ì§„êµ¬": {coords: {lat: 35.1595, lng: 129.0594}},
					"ë¶êµ¬": {coords: {lat: 35.2000, lng: 129.0010}},
					"ì‚¬ìƒêµ¬": {coords: {lat: 35.1440, lng: 128.9790}},
					"ì‚¬í•˜êµ¬": {coords: {lat: 35.0960, lng: 128.9790}},
					"ì„œêµ¬": {coords: {lat: 35.0960, lng: 129.0140}},
					"ìˆ˜ì˜êµ¬": {coords: {lat: 35.1580, lng: 129.1160}},
					"ì—°ì œêµ¬": {coords: {lat: 35.1790, lng: 129.0860}},
					"ì˜ë„êµ¬": {coords: {lat: 35.0660, lng: 129.1000}},
					"ì¤‘êµ¬": {coords: {lat: 35.1130, lng: 129.0400}}
				}
			},
			ëŒ€êµ¬: {
				coords: {lat: 35.8714, lng: 128.6014},
				districts: {
					"ë‚¨êµ¬": {coords: {lat: 35.8450, lng: 128.6010}},
					"ë‹¬ì„œêµ¬": {coords: {lat: 35.8350, lng: 128.5800}},
					"ë‹¬ì„±êµ°": {coords: {lat: 35.7070, lng: 128.4870}},
					"ë™êµ¬": {coords: {lat: 35.8700, lng: 128.6100}},
					"ë¶êµ¬": {coords: {lat: 35.8950, lng: 128.6000}},
					"ì„œêµ¬": {coords: {lat: 35.8700, lng: 128.5500}},
					"ìˆ˜ì„±êµ¬": {coords: {lat: 35.8460, lng: 128.6100}},
					"ì¤‘êµ¬": {coords: {lat: 35.8700, lng: 128.6000}}
				}
			},
			ì¸ì²œ: {
				coords: {lat: 37.4563, lng: 126.7052},
				districts: {
					"ê°•í™”êµ°": {coords: {lat: 37.7030, lng: 126.4870}},
					"ê³„ì–‘êµ¬": {coords: {lat: 37.5160, lng: 126.7250}},
					"ë‚¨ë™êµ¬": {coords: {lat: 37.4480, lng: 126.7240}},
					"ë™êµ¬": {coords: {lat: 37.4870, lng: 126.6170}},
					"ë¯¸ì¶”í™€êµ¬": {coords: {lat: 37.4630, lng: 126.6340}},
					"ë¶€í‰êµ¬": {coords: {lat: 37.5070, lng: 126.7240}},
					"ì„œêµ¬": {coords: {lat: 37.4870, lng: 126.6500}},
					"ì—°ìˆ˜êµ¬": {coords: {lat: 37.4480, lng: 126.6830}},
					"ì˜¹ì§„êµ°": {coords: {lat: 37.5000, lng: 126.5000}},
					"ì¤‘êµ¬": {coords: {lat: 37.4630, lng: 126.6500}}
				}
			},
			ê´‘ì£¼: {
				coords: {lat: 35.1595, lng: 126.8526},
				districts: {
					"ê´‘ì‚°êµ¬": {coords: {lat: 35.1890, lng: 126.8450}},
					"ë‚¨êµ¬": {coords: {lat: 35.1450, lng: 126.8500}},
					"ë™êµ¬": {coords: {lat: 35.1570, lng: 126.8500}},
					"ë¶êµ¬": {coords: {lat: 35.1740, lng: 126.8500}},
					"ì„œêµ¬": {coords: {lat: 35.1550, lng: 126.8500}}
				}
			},
			ëŒ€ì „: {
				coords: {lat: 36.3504, lng: 127.3845},
				districts: {
					"ëŒ€ë•êµ¬": {coords: {lat: 36.3730, lng: 127.3960}},
					"ë™êµ¬": {coords: {lat: 36.3470, lng: 127.3920}},
					"ì„œêµ¬": {coords: {lat: 36.3530, lng: 127.3850}},
					"ìœ ì„±êµ¬": {coords: {lat: 36.3660, lng: 127.3660}},
					"ì¤‘êµ¬": {coords: {lat: 36.3480, lng: 127.3840}}
				}
			},
			ìš¸ì‚°: {
				coords: {lat: 35.5384, lng: 129.3114},
				districts: {
					"ë‚¨êµ¬": {coords: {lat: 35.5250, lng: 129.3000}},
					"ë™êµ¬": {coords: {lat: 35.5500, lng: 129.3000}},
					"ë¶êµ¬": {coords: {lat: 35.5700, lng: 129.3000}},
					"ìš¸ì£¼êµ°": {coords: {lat: 35.5400, lng: 129.3000}},
					"ì¤‘êµ¬": {coords: {lat: 35.5300, lng: 129.3000}}
				}
			},
			ì„¸ì¢…: {
				coords: {lat: 36.4802, lng: 127.2895},
				districts: {
					"ì„¸ì¢…ì‹œ": {coords: {lat: 36.4802, lng: 127.2895}}
				}
			},
			ê²½ê¸°: {
				coords: {lat: 37.4138, lng: 127.5183},
				districts: {
					"ê°€í‰êµ°": {coords: {lat: 37.8340, lng: 127.4870}},
					"ê³ ì–‘ì‹œ": {coords: {lat: 37.6700, lng: 126.8300}},
					"ê³¼ì²œì‹œ": {coords: {lat: 37.4780, lng: 126.9890}},
					"ê´‘ëª…ì‹œ": {coords: {lat: 37.4780, lng: 126.9000}},
					"ê´‘ì£¼ì‹œ": {coords: {lat: 37.3980, lng: 127.2530}},
					"êµ¬ë¦¬ì‹œ": {coords: {lat: 37.6000, lng: 127.1300}},
					"êµ°í¬ì‹œ": {coords: {lat: 37.3590, lng: 126.9500}},
					"ê¹€í¬ì‹œ": {coords: {lat: 37.6160, lng: 126.6500}},
					"ë‚¨ì–‘ì£¼ì‹œ": {coords: {lat: 37.6350, lng: 127.2000}},
					"ë™ë‘ì²œì‹œ": {coords: {lat: 37.9010, lng: 127.0600}},
					"ë¶€ì²œì‹œ": {coords: {lat: 37.4870, lng: 126.7830}},
					"ì„±ë‚¨ì‹œ": {coords: {lat: 37.4400, lng: 127.1280}},
					"ìˆ˜ì›ì‹œ": {coords: {lat: 37.2630, lng: 127.0280}},
					"ì‹œí¥ì‹œ": {coords: {lat: 37.3830, lng: 126.8000}},
					"ì•ˆì‚°ì‹œ": {coords: {lat: 37.3190, lng: 126.8300}},
					"ì•ˆì„±ì‹œ": {coords: {lat: 37.0050, lng: 127.2770}},
					"ì–‘ì£¼ì‹œ": {coords: {lat: 37.8000, lng: 127.0500}},
					"ì–‘í‰êµ°": {coords: {lat: 37.5000, lng: 127.5000}},
					"ì—¬ì£¼ì‹œ": {coords: {lat: 37.3000, lng: 127.4000}},
					"ì˜¤ì‚°ì‹œ": {coords: {lat: 37.1500, lng: 127.0500}},
					"ìš©ì¸ì‹œ": {coords: {lat: 37.2410, lng: 127.1770}},
					"ì˜ì™•ì‹œ": {coords: {lat: 37.3350, lng: 126.9930}},
					"ì˜ì •ë¶€ì‹œ": {coords: {lat: 37.7380, lng: 127.0500}},
					"ì´ì²œì‹œ": {coords: {lat: 37.2800, lng: 127.4500}},
					"íŒŒì£¼ì‹œ": {coords: {lat: 37.7590, lng: 126.7700}},
					"í‰íƒì‹œ": {coords: {lat: 37.0730, lng: 127.1000}},
					"í•˜ë‚¨ì‹œ": {coords: {lat: 37.5450, lng: 127.2000}},
					"í™”ì„±ì‹œ": {coords: {lat: 37.2050, lng: 126.8000}}
				}
			},
			ê°•ì›: {
				coords: {lat: 37.8228, lng: 128.1555},
				districts: {
					"ê°•ë¦‰ì‹œ": {coords: {lat: 37.7510, lng: 128.8760}},
					"ê³ ì„±êµ°": {coords: {lat: 38.2000, lng: 128.6000}},
					"ë™í•´ì‹œ": {coords: {lat: 37.5080, lng: 128.8950}},
					"ì‚¼ì²™ì‹œ": {coords: {lat: 37.4480, lng: 129.1640}},
					"ì†ì´ˆì‹œ": {coords: {lat: 38.2070, lng: 128.5910}},
					"ì–‘êµ¬êµ°": {coords: {lat: 38.1000, lng: 128.5000}},
					"ì–‘ì–‘êµ°": {coords: {lat: 38.0660, lng: 128.6170}},
					"ì˜ì›”êµ°": {coords: {lat: 37.1740, lng: 127.6000}},
					"ì›ì£¼ì‹œ": {coords: {lat: 37.3470, lng: 127.9200}},
					"ì² ì›êµ°": {coords: {lat: 38.2000, lng: 127.3000}},
					"ì¶˜ì²œì‹œ": {coords: {lat: 37.8830, lng: 127.7300}},
					"íƒœë°±ì‹œ": {coords: {lat: 37.1500, lng: 128.9960}},
					"í‰ì°½êµ°": {coords: {lat: 37.3660, lng: 128.4000}},
					"í™ì²œêµ°": {coords: {lat: 37.7000, lng: 127.8000}},
					"í™”ì²œêµ°": {coords: {lat: 38.1000, lng: 127.5000}},
					"íš¡ì„±êµ°": {coords: {lat: 37.3000, lng: 127.6000}}
				}
			},
			ì¶©ë¶: {
				coords: {lat: 36.6359, lng: 127.4914},
				districts: {
					"ê´´ì‚°êµ°": {coords: {lat: 36.7400, lng: 137.0000}},
					"ë‹¨ì–‘êµ°": {coords: {lat: 36.9990, lng: 128.3000}},
					"ë³´ì€êµ°": {coords: {lat: 36.5000, lng: 127.7000}},
					"ì˜ë™êµ°": {coords: {lat: 36.3000, lng: 127.5000}},
					"ì˜¥ì²œêµ°": {coords: {lat: 36.5000, lng: 127.4000}},
					"ìŒì„±êµ°": {coords: {lat: 36.5000, lng: 127.6000}},
					"ì œì²œì‹œ": {coords: {lat: 37.1500, lng: 128.2000}},
					"ì²­ì£¼ì‹œ": {coords: {lat: 36.6500, lng: 127.5000}},
					"ì¶©ì£¼ì‹œ": {coords: {lat: 36.9500, lng: 127.4000}}
				}
			},
			ì¶©ë‚¨: {
				coords: {lat: 36.6359, lng: 126.6772},
				districts: {
					"ê³„ë£¡ì‹œ": {coords: {lat: 36.3000, lng: 127.1000}},
					"ê³µì£¼ì‹œ": {coords: {lat: 36.5000, lng: 127.2000}},
					"ë…¼ì‚°ì‹œ": {coords: {lat: 36.2000, lng: 127.3000}},
					"ë‹¹ì§„ì‹œ": {coords: {lat: 36.8000, lng: 126.7000}},
					"ë³´ë ¹ì‹œ": {coords: {lat: 36.3000, lng: 126.6000}},
					"ì„œì‚°ì‹œ": {coords: {lat: 36.7000, lng: 126.5000}},
					"ì•„ì‚°ì‹œ": {coords: {lat: 36.5000, lng: 126.8000}},
					"ì²œì•ˆì‹œ": {coords: {lat: 36.8000, lng: 127.0000}},
					"ì²­ì–‘êµ°": {coords: {lat: 36.5000, lng: 126.8000}},
					"íƒœì•ˆêµ°": {coords: {lat: 36.5000, lng: 126.3000}},
					"í™ì„±êµ°": {coords: {lat: 36.5000, lng: 126.6000}}
				}
			},
			ì „ë¶: {
				coords: {lat: 35.7194, lng: 127.1445},
				districts: {
					"ê³ ì°½êµ°": {coords: {lat: 35.4000, lng: 126.7000}},
					"êµ°ì‚°ì‹œ": {coords: {lat: 35.9650, lng: 126.7300}},
					"ê¹€ì œì‹œ": {coords: {lat: 35.8000, lng: 126.9000}},
					"ë‚¨ì›ì‹œ": {coords: {lat: 35.4000, lng: 127.4000}},
					"ìµì‚°ì‹œ": {coords: {lat: 35.9500, lng: 126.8000}},
					"ì „ì£¼ì‹œ": {coords: {lat: 35.8000, lng: 127.1500}},
					"ì •ìì‹œ": {coords: {lat: 35.5700, lng: 126.8500}},
					"ì™„ì£¼êµ°": {coords: {lat: 35.8000, lng: 127.2000}},
					"ì„ì‹¤êµ°": {coords: {lat: 35.5000, lng: 127.3000}},
					"ì¥ìˆ˜êµ°": {coords: {lat: 35.6000, lng: 127.5000}},
					"ì§„ì•ˆêµ°": {coords: {lat: 35.7000, lng: 127.3000}}
				}
			},
			ì „ë‚¨: {
				coords: {lat: 34.8144, lng: 126.4633},
				districts: {
					"ê°•ì§„êµ°": {coords: {lat: 34.6000, lng: 126.7000}},
					"ê³ í¥êµ°": {coords: {lat: 34.6000, lng: 126.5000}},
					"ê³¡ì„±êµ°": {coords: {lat: 35.0000, lng: 127.0000}},
					"ê´‘ì–‘ì‹œ": {coords: {lat: 34.9500, lng: 127.7000}},
					"êµ¬ë¡€êµ°": {coords: {lat: 35.2000, lng: 127.6000}},
					"ë‚˜ì£¼": {coords: {lat: 35.0000, lng: 126.8000}},
					"ë‹´ì–‘êµ°": {coords: {lat: 35.3000, lng: 126.8000}},
					"ëª©í¬ì‹œ": {coords: {lat: 34.8000, lng: 126.4000}},
					"ë¬´ì•ˆêµ°": {coords: {lat: 34.8000, lng: 126.6000}},
					"ë³´ì„±êµ°": {coords: {lat: 34.8000, lng: 127.0000}},
					"ì‹ ì•ˆêµ°": {coords: {lat: 34.6000, lng: 126.3000}},
					"ì—¬ìˆ˜ì‹œ": {coords: {lat: 34.7500, lng: 127.7000}},
					"ì˜ê´‘êµ°": {coords: {lat: 35.2000, lng: 126.6000}},
					"ì˜ì•”êµ°": {coords: {lat: 34.8000, lng: 126.6000}},
					"ì™„ë„êµ°": {coords: {lat: 34.3000, lng: 126.7000}},
					"ì¥ì„±êµ°": {coords: {lat: 35.3000, lng: 126.8000}},
					"ì¥í¥êµ°": {coords: {lat: 34.6000, lng: 126.5000}},
					"ì§„ë„êµ°": {coords: {lat: 34.5000, lng: 126.3000}},
					"í•¨í‰êµ°": {coords: {lat: 35.0000, lng: 126.5000}},
					"í•´ë‚¨êµ°": {coords: {lat: 34.5000, lng: 126.5000}},
					"í™”ìˆœêµ°": {coords: {lat: 35.0000, lng: 126.7000}}
				}
			},
			ê²½ë¶: {
				coords: {lat: 36.4911, lng: 128.8889},
				districts: {
					"ê²½ì‚°ì‹œ": {coords: {lat: 35.8000, lng: 128.7000}},
					"ê²½ì£¼": {coords: {lat: 35.8500, lng: 129.2000}},
					"ê³ ë ¹êµ°": {coords: {lat: 35.6000, lng: 128.4000}},
					"êµ¬ë¯¸ì‹œ": {coords: {lat: 36.1000, lng: 128.3000}},
					"ê¹€ì²œì‹œ": {coords: {lat: 35.7000, lng: 128.1000}},
					"ë¬¸ê²½ì‹œ": {coords: {lat: 36.5700, lng: 128.3000}},
					"ìƒì£¼": {coords: {lat: 36.4000, lng: 128.2000}},
					"ì„±ì£¼êµ°": {coords: {lat: 35.8000, lng: 128.5000}},
					"ì•ˆë™ì‹œ": {coords: {lat: 36.5600, lng: 128.7000}},
					"ì˜ì£¼": {coords: {lat: 36.8000, lng: 128.6000}},
					"ì˜ì²œì‹œ": {coords: {lat: 35.9000, lng: 128.8000}},
					"ì˜ˆì²œêµ°": {coords: {lat: 36.5000, lng: 128.3000}},
					"ìš¸ë¦‰êµ°": {coords: {lat: 37.5000, lng: 130.8000}},
					"ìš¸ì§„êµ°": {coords: {lat: 36.9000, lng: 129.4000}},
					"í¬í•­ì‹œ": {coords: {lat: 36.0200, lng: 129.3500}}
				}
			},
			ê²½ë‚¨: {
				coords: {lat: 35.2345, lng: 128.6922},
				districts: {
					"ê±°ì œì‹œ": {coords: {lat: 34.9000, lng: 128.6000}},
					"ê±°ì°½êµ°": {coords: {lat: 35.6000, lng: 127.9000}},
					"ê³ ì„±êµ°": {coords: {lat: 35.2000, lng: 128.5000}},
					"ê¹€í•´ì‹œ": {coords: {lat: 35.2000, lng: 128.8000}},
					"ë‚¨í•´êµ°": {coords: {lat: 34.8000, lng: 128.4000}},
					"ë°€ì–‘ì‹œ": {coords: {lat: 35.5000, lng: 128.7000}},
					"ì‚¬ì²œì‹œ": {coords: {lat: 35.0000, lng: 128.6000}},
					"ì‚°ì²­êµ°": {coords: {lat: 35.3000, lng: 127.8000}},
					"ì–‘ì‚°ì‹œ": {coords: {lat: 35.3000, lng: 129.0000}},
					"ì˜ë ¹êµ°": {coords: {lat: 35.3000, lng: 128.5000}},
					"ì§„ì£¼": {coords: {lat: 35.2000, lng: 128.1000}},
					"ì°½ë…•êµ°": {coords: {lat: 35.3000, lng: 128.4000}},
					"ì°½ì›ì‹œ": {coords: {lat: 35.2000, lng: 128.6000}},
					"í†µì˜ì‹œ": {coords: {lat: 34.8000, lng: 128.4000}}
				}
			},
			ì œì£¼: {
				coords: {lat: 33.4996, lng: 126.5312},
				districts: {
					"ì„œê·€í¬ì‹œ": {coords: {lat: 33.2540, lng: 126.5600}},
					"ì œì£¼ì‹œ": {coords: {lat: 33.4996, lng: 126.5312}}
				}
			}
		};

		$(document).ready(function () {
			loadAllStores();
			let city, district;

			$('#city').change(function () {
				city = $(this).val();
				const districtSelect = $('#district');

				districtSelect.empty(); // ê¸°ì¡´ ì˜µì…˜ ì œê±°
				if (city) {
					districtSelect.append('<option value="">êµ¬ ì„ íƒ</option>');
					// Object.keys()ë¥¼ ì‚¬ìš©í•˜ì—¬ êµ¬ì—­ ì´ë¦„ì„ ê°€ì ¸ì˜´
					Object.keys(districts[city].districts).forEach(function (district) {
						districtSelect.append(`<option value="${district}">${district}</option>`);
					});
					districtSelect.prop('disabled', false); // êµ¬ ì„ íƒ ê°€ëŠ¥
				} else {
					districtSelect.append('<option value="">ì‹œ/ë„ë¥¼ ì„ íƒí•˜ì„¸ìš”</option>');
					districtSelect.prop('disabled', true); // êµ¬ ì„ íƒ ë¶ˆê°€ëŠ¥
				}
			});

			$('#district').change(function () {
				const district = $(this).val();

				if (city && district) {
					fetchRestaurants(city, district);
					loadAllStores(city, district);
				}
			});


			// ì‚¬ìš©ìì˜ ìœ„ì¹˜ë¥¼ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜
			function getUserLocation() {
				if (navigator.geolocation) {
					navigator.geolocation.getCurrentPosition(function (position) {
						const lat = position.coords.latitude;
						const lng = position.coords.longitude;
						fetchRestaurantsByLocation(lat, lng); // ì‚¬ìš©ì ìœ„ì¹˜ë¡œ ì‹ë‹¹ ì •ë³´ ìš”ì²­
					}, function () {
						alert("ìœ„ì¹˜ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
					});
				} else {
					alert("ì´ ë¸Œë¼ìš°ì €ëŠ” Geolocationì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
				}
			}

			// ì‚¬ìš©ì ìœ„ì¹˜ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì‹ë‹¹ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜
			function fetchRestaurantsByLocation(lat, lng) {
				const radius = 5000; // 5km ë°˜ê²½
				const apiUrl = `https://dapi.kakao.com/v2/local/search/keyword.json?query=ë¹„ê±´&category_group_code=FD6&x=${lng}&y=${lat}&radius=${radius}&size=15`;
				$.ajax({
					url: apiUrl,
					type: 'GET',
					headers: {
						Authorization: 'KakaoAK 79b293f9f7248b594b68090c70db6c6f' // ì¹´ì¹´ì˜¤ REST API í‚¤ ì…ë ¥
					},
					success: function (data) {
						allRestaurants = data.documents; // ì‹ë‹¹ ì •ë³´ë¥¼ ì €ì¥
						allRestaurants.forEach(restaurant => {
							const addressParts = restaurant.address_name.split(' '); // ì£¼ì†Œë¥¼ ê³µë°±ìœ¼ë¡œ ë¶„í• 
							const region = addressParts.slice(0, 1).join(' '); // ì²« ë²ˆì§¸ ë¶€ë¶„ (ì˜ˆ: ê²½ê¸°ë„)
							const district = addressParts.slice(1, 2).join(' '); // ë‘ ë²ˆì§¸ ë¶€ë¶„ (ì˜ˆ: ìˆ˜ì›ì‹œ)
							displayRestaurants(allRestaurants, region, district); // ê° ì‹ë‹¹ ë¦¬ìŠ¤íŠ¸ í‘œì‹œ
						});
					},
					error: function (error) {
						console.error("Error fetching data: ", error);
						alert("ì‹ë‹¹ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë° ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
					}
				});
			}

			// í˜ì´ì§€ ë¡œë“œ ì‹œ ì‚¬ìš©ìì˜ ìœ„ì¹˜ë¥¼ ê°€ì ¸ì˜´
			getUserLocation();

			$(".getUserLocationBtn").on("click", function () {
				if (confirm("í˜„ì¬ ìœ„ì¹˜ë¡œ ì´ë™í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
					loadNearbyStores();
				}
			})
		});

		let allRestaurants = []; // ëª¨ë“  ì‹ë‹¹ ì •ë³´ë¥¼ ì €ì¥í•  ë°°ì—´
		let currentPage = 1; // í˜„ì¬ í˜ì´ì§€

		function fetchRestaurants(city, district) {

			// ìƒˆë¡œìš´ ì§€ì—­ì„ ì„ íƒí•  ë•Œ allRestaurantsë¥¼ ì´ˆê¸°í™”
			allRestaurants = []; // ë°°ì—´ ì´ˆê¸°í™”
			currentPage = 1; // í˜ì´ì§€ ì´ˆê¸°í™”

			const coords = districts[city].districts[district].coords;
			const lat = coords.lat; // ìœ„ë„
			const lng = coords.lng; // ê²½ë„
			const radius = 5000; // 2km ë°˜ê²½
			const apiUrl = `https://dapi.kakao.com/v2/local/search/keyword.json?query=ë¹„ê±´&category_group_code=FD6&x=${lng}&y=${lat}&radius=${radius}&size=15`;

			function fetchPage(page) {
				$.ajax({
					url: `${apiUrl}&page=${page}`, // í˜ì´ì§€ ë²ˆí˜¸ ì¶”ê°€
					type: 'GET',
					headers: {
						Authorization: 'KakaoAK 79b293f9f7248b594b68090c70db6c6f' // ì¹´ì¹´ì˜¤ REST API í‚¤ ì…ë ¥
					},
					success: function (data) {
						allRestaurants = allRestaurants.concat(data.documents); // í˜„ì¬ í˜ì´ì§€ì˜ ì‹ë‹¹ ì •ë³´ë¥¼ ì¶”ê°€
						if (data.meta.is_end) {
							displayRestaurants(allRestaurants, city, district);

						} else {
							fetchPage(page + 1); // ë‹¤ìŒ í˜ì´ì§€ê°€ ìˆìœ¼ë©´ ê³„ì†í•´ì„œ ê°€ì ¸ì˜´
						}
					},
					error: function (error) {
						console.error("Error fetching data: ", error);
						alert("ì‹ë‹¹ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë° ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
					}
				});
			}

			fetchPage(1); // ì²« í˜ì´ì§€ë¶€í„° ì‹œì‘
		}



		// ëœë¤ ë°°ì—´ ìƒì„± (ê°ê° 20ê°œ í•­ëª©)
		const stoTitles = [
			'ì¹œí™˜ê²½ ê±´ê°• ì¹´í˜', 'ë¹„ê±´ ë ˆìŠ¤í† ë‘', 'ìì—°ì£¼ì˜ ìš”ë¦¬', 'ì±„ì‹ ì „ë¬¸ì ', 'ìœ ê¸°ë† ì±„ì‹ë‹¹',
			'ë¹„ê±´ ë²„ê±°ìƒµ', 'ì±„ì‹ ë·”í˜', 'ë¹„ê±´ ë””ì €íŠ¸ ì¹´í˜', 'ë¡œì»¬ ì¬ë£Œ ë¹„ê±´ ì‹ë‹¹', 'ë¹„ê±´ í”¼ì í•˜ìš°ìŠ¤',
			'ë¹„ê±´ ìŠ¤ì‹œ ë°”', 'ë¹„ê±´ ìƒŒë“œìœ„ì¹˜ ìŠ¤í† ì–´', 'ë¹„ê±´ ë¹„ë¹”ë°¥ ì „ë¬¸ì ', 'ë¬´ì²¨ê°€ ê±´ê°•ì‹ë‹¹', 'ì±„ì‹ ë²„ì„¯ì§‘',
			'ë¹„ê±´ íƒ€ì½” í•˜ìš°ìŠ¤', 'ì±„ì†Œì™€ ì½© ì‹ë‹¹', 'ë¹„ê±´ ìŠ¤ë¬´ë”” ì¹´í˜', 'ì§€ì†ê°€ëŠ¥ ì‹ë‹¨ ì „ë¬¸ì ', 'ë¹„ê±´ ë„ì‹œë½ ê°€ê²Œ'
		];

		const stoContents = [
			'ê±´ê°•í•œ ì‹ë‹¨ì„ ì œê³µí•©ë‹ˆë‹¤.', 'ë‹¤ì–‘í•œ ì±„ì‹ ìš”ë¦¬ë¥¼ ë§›ë³´ì„¸ìš”.', 'ë¹„ê±´ ë””ì €íŠ¸ê°€ ìœ ëª…í•œ ê³³ì…ë‹ˆë‹¤.',
			'ìœ ê¸°ë† ì¬ë£Œë§Œ ì‚¬ìš©í•©ë‹ˆë‹¤.', 'í™˜ê²½ ì¹œí™”ì ì¸ ê°€ê²Œì…ë‹ˆë‹¤.', 'ë¹„ê±´ ë²„ê±°ë¥¼ ì¦ê¸¸ ìˆ˜ ìˆëŠ” ê³³ì…ë‹ˆë‹¤.',
			'ë§¤ì¼ ì‹ ì„ í•œ ì±„ì†Œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.', 'ê¸€ë£¨í… í”„ë¦¬ ì˜µì…˜ë„ ìˆìŠµë‹ˆë‹¤.', 'ë¡œì»¬ ì¬ë£Œë¥¼ ì‚¬ìš©í•œ ë©”ë‰´ë¥¼ ì„ ë³´ì…ë‹ˆë‹¤.',
			'ê°€ì¡±ê³¼ í•¨ê»˜ ì¦ê¸¸ ìˆ˜ ìˆëŠ” ë¹„ê±´ ì‹ë‹¹ì…ë‹ˆë‹¤.', 'ì±„ì‹ì˜ ë§¤ë ¥ì„ ëŠë‚„ ìˆ˜ ìˆëŠ” ê³³ì…ë‹ˆë‹¤.', 'ë¹„ê±´ ì™€í”Œì„ ì œê³µí•©ë‹ˆë‹¤.',
			'ìƒ‰ë‹¤ë¥¸ ë¹„ê±´ ìš”ë¦¬ë¥¼ ë§Œë‚  ìˆ˜ ìˆìŠµë‹ˆë‹¤.', 'ë¹„ê±´ í”¼í¬ë‹‰ ì„¸íŠ¸ê°€ ìˆìŠµë‹ˆë‹¤.', 'ì±„ì‹ë§Œìœ¼ë¡œë„ ë“ ë“ í•œ í•œ ë¼ë¥¼ ì œê³µí•©ë‹ˆë‹¤.',
			'ì•„ì´ë“¤ì„ ìœ„í•œ ë¹„ê±´ ë©”ë‰´ë„ ì¤€ë¹„ë˜ì–´ ìˆìŠµë‹ˆë‹¤.', 'í•´ì™¸ ë¹„ê±´ ìš”ë¦¬ë¥¼ ì„ ë³´ì´ëŠ” ê³³ì…ë‹ˆë‹¤.', 'ì£¼ë§ ë¸ŒëŸ°ì¹˜ê°€ ì¸ê¸°ì…ë‹ˆë‹¤.',
			'ë¹„ê±´ ì†ŒìŠ¤ì™€ ë“œë ˆì‹±ì„ ë§Œë‚  ìˆ˜ ìˆìŠµë‹ˆë‹¤.', 'ë¹„ê±´ ì „ë¬¸ ìš”ë¦¬ì‚¬ë“¤ì´ ì¤€ë¹„í•œ ì‹ë‹¹ì…ë‹ˆë‹¤.'
		];

		const stoImages = [
			'/imgs/map/image1.jpg', '/imgs/map/image2.jpg', '/imgs/map/image3.jpg',
			'/imgs/map/image4.jpg', '/imgs/map/image5.jpg', '/imgs/map/image6.jpg',
			'/imgs/map/image7.jpg', '/imgs/map/image8.jpg', '/imgs/map/image9.jpg',
			'/imgs/map/image10.jpg', '/imgs/map/image11.jpg', '/imgs/map/image12.jpg',
			'/imgs/map/image13.jpg', '/imgs/map/image14.jpg', '/imgs/map/image15.jpg',
			'/imgs/map/image16.jpg', '/imgs/map/image17.jpg', '/imgs/map/image18.jpg',
			'/imgs/map/image19.jpg', '/imgs/map/image20.jpg'
		];

		const stoOperatingHours = [
			'10:00 - 22:00', '11:00 - 21:00', '09:00 - 20:00', '12:00 - 23:00', '08:00 - 18:00',
			'10:00 - 21:00', '11:30 - 22:30', '07:00 - 19:00', '10:00 - 20:00', '09:00 - 22:00',
			'08:30 - 19:30', '09:00 - 21:00', '12:00 - 21:00', '11:00 - 20:00', '09:30 - 22:00',
			'10:00 - 20:30', '07:00 - 18:00', '10:00 - 23:00', '08:00 - 20:00', '09:00 - 19:00'
		];

		const stoClosedDays = [
			'ë§¤ì£¼ ì›”ìš”ì¼ íœ´ë¬´', 'ì²«ì§¸ ì£¼ í™”ìš”ì¼ íœ´ë¬´', 'ë§¤ì£¼ ìˆ˜ìš”ì¼ íœ´ë¬´', 'ê³µíœ´ì¼ íœ´ë¬´', 'ë§¤ì£¼ ê¸ˆìš”ì¼ íœ´ë¬´',
			'ë‘˜ì§¸, ë„·ì§¸ ì£¼ ì¼ìš”ì¼ íœ´ë¬´', 'ë§¤ì›” ë§ˆì§€ë§‰ ì£¼ í† ìš”ì¼ íœ´ë¬´', 'ì—°ì¤‘ë¬´íœ´', 'ë§¤ì£¼ í† ìš”ì¼ íœ´ë¬´', 'ë‘˜ì§¸ ì£¼ ëª©ìš”ì¼ íœ´ë¬´',
			'ë§¤ì£¼ ëª©ìš”ì¼ íœ´ë¬´', 'ë§¤ì›” ë‘˜ì§¸ ì£¼ ìˆ˜ìš”ì¼ íœ´ë¬´', 'ì…‹ì§¸ ì£¼ ì¼ìš”ì¼ íœ´ë¬´', 'ê³µíœ´ì¼ ì „ë‚  íœ´ë¬´', 'ë§¤ë‹¬ ì²«ì§¸ ì£¼ ì›”ìš”ì¼ íœ´ë¬´',
			'ê³µíœ´ì¼ ê°œì¥', 'ì£¼ë§ê³¼ ê³µíœ´ì¼ ì—°ì¥ ì˜ì—…', 'ì²«ì§¸, ì…‹ì§¸ ì£¼ ì›”ìš”ì¼ íœ´ë¬´', 'ë¹„ì˜¤ëŠ” ë‚  íœ´ë¬´', 'ì—¬ë¦„ íœ´ê°€ì²  íœ´ë¬´'
		];

		const stoRecommendedMenus = [
			'ë¹„ê±´ ë²„ê±°', 'í† ë§ˆí†  íŒŒìŠ¤íƒ€', 'ì•„ë³´ì¹´ë„ ìƒëŸ¬ë“œ', 'êµ¬ìš´ ì±„ì†Œ í”Œë˜í„°', 'ë¹„ê±´ í”¼ì',
			'ë Œí‹¸ì½© ìŠ¤í”„', 'ê·¸ë¦° ìŠ¤ë¬´ë””', 'ë¹„ê±´ ì´ˆì½œë¦¿ ì¼€ì´í¬', 'ìœ ê¸°ë† í˜„ë¯¸ë°¥', 'ë¹„ê±´ ë¼ìëƒ',
			'ë¹„ê±´ íƒ€ì½”', 'ì–‘ìƒì¶” ë©', 'ë¹„ê±´ ì´ˆë°¥', 'ì±„ì†Œ ë®ë°¥', 'ë¹„ê±´ ë¼ë©´',
			'ì½”ì½”ë„› ì¹´ë ˆ', 'ë‘ë¶€ ìƒëŸ¬ë“œ', 'ê³¼ì¼ í”Œë˜í„°', 'ë¹„ê±´ ì¹˜ì¦ˆ ì¼€ì´í¬', 'ë¹„ê±´ íŒŒë‹ˆë‹ˆ'
		];

		const stoParkingInfos = [
			'ì£¼ì°¨ ê°€ëŠ¥', 'ì£¼ì°¨ ë¶ˆê°€', 'ì¸ê·¼ ê³µìš© ì£¼ì°¨ì¥ ì´ìš©', 'ê°€ê²Œ ì• ë¬´ë£Œ ì£¼ì°¨', 'ë°œë › íŒŒí‚¹ ì„œë¹„ìŠ¤ ì œê³µ',
			'ê°€ê²Œ ë’¤ìª½ ì£¼ì°¨ì¥', 'ì§€í•˜ ì£¼ì°¨ì¥', 'ì¸ê·¼ ìœ ë£Œ ì£¼ì°¨ì¥ ì´ìš©', 'ì£¼ì°¨ ê³µê°„ í˜‘ì†Œ', 'ì£¼ì°¨ ì§€ì› ì—†ìŒ',
			'ì£¼ì°¨ êµ¬ì—­ ì•ˆë‚´í‘œì§€ ìˆìŒ', 'ì£¼ì°¨ì¥ ìˆìŒ', 'ì£¼ì°¨ê°€ í˜¼ì¡í•  ìˆ˜ ìˆìŒ', 'ì£¼ë§ì—ë§Œ ì£¼ì°¨ ê°€ëŠ¥', 'ê°€ê²Œ ì• ì£¼ì°¨ ê¸ˆì§€',
			'ìì „ê±° ì£¼ì°¨ ê°€ëŠ¥', 'ì „ê¸°ì°¨ ì¶©ì „ ì£¼ì°¨ ê°€ëŠ¥', '1ì‹œê°„ ë¬´ë£Œ ì£¼ì°¨', 'ì£¼ì°¨ ê³µê°„ ë„‰ë„‰í•¨', 'ì €ë… ì‹œê°„ ì£¼ì°¨ ê¸ˆì§€'
		];

		const stoVegetarianType = [
			'ë¹„ê±´', 'í”„ë£¨í…Œë¦¬ì–¸', 'ë½í†  ë² ì§€í…Œë¦¬ì–¸', 'ì˜¤ë³´ ë² ì§€í…Œë¦¬ì–¸', 'ë½í†  ì˜¤ë³´ ë² ì§€í…Œë¦¬ì–¸', 'í˜ìŠ¤ì½” ë² ì§€í…Œë¦¬ì–¸',
			'í´ë¡œ ë² ì§€í…Œë¦¬ì–¸', 'í”Œë ‰ì‹œí…Œë¦¬ì–¸'
		]

		// ëœë¤ ì„ íƒ í•¨ìˆ˜
		function getRandomItem(arr) {
			return arr[Math.floor(Math.random() * arr.length)];
		}

		async function displayRestaurants(restaurants, city, district) {
			const restaurantList = $('#restaurantList');

			for (const restaurant of restaurants) {
				const placeName = restaurant.place_name;
				const address = restaurant.road_address_name || restaurant.address_name;
				const phoneNumber = restaurant.phone || 'ì „í™”ë²ˆí˜¸ ì—†ìŒ';
				const category = restaurant.category_name || 'ì¹´í…Œê³ ë¦¬ ì—†ìŒ';
				const lat = restaurant.y; // ìœ„ë„
				const lng = restaurant.x; // ê²½ë„
				const uniqueId = restaurant.id; // ì¹´ì¹´ì˜¤ë§µ APIì—ì„œ ì œê³µí•˜ëŠ” ê³ ìœ  ID




				// ëœë¤í•œ ê°’ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„° ì±„ìš°ê¸°
				const storeData = {
					stoName: placeName,
					stoTitle: getRandomItem(stoTitles),
					stoContent: getRandomItem(stoContents),
					stoCategory: category,
					stoRegionProvince: city,
					stoRegionCity: district,
					viewCount: 0,
					recommendationCount: 0,
					stoContact: phoneNumber,
					stoAddress: address,
					stoImage: getRandomItem(stoImages),
					stoOperatingHours: getRandomItem(stoOperatingHours),
					stoClosedDays: getRandomItem(stoClosedDays),
					stoRecommendedMenu: getRandomItem(stoRecommendedMenus),
					stoParkingInfo: getRandomItem(stoParkingInfos),
					stoLatitude: lat,
					stoLongitude: lng,
					stoVegetarianType: getRandomItem(stoVegetarianType),
					createdAt: new Date(),
					updatedAt: new Date(),
					isOpen: true,
					kakaoStoreId: uniqueId,
					storeReviews: [
						{
							revId: 0,
							revImg: "",
							revText: "",
							revRating: 0,
							writer: ""
						}
					] // ë¹ˆ ë¦¬ìŠ¤íŠ¸ë¡œ ì´ˆê¸°í™”
				};

				// ê³ ìœ  ID ì¡´ì¬ ì—¬ë¶€ ì²´í¬
				const exists = await checkIfExists(uniqueId);
				if (exists) {
					continue; // ì¤‘ë³µëœ ê²½ìš° ë‹¤ìŒ ë ˆìŠ¤í† ë‘ìœ¼ë¡œ ë„˜ì–´ê°
				}

				// APIë¥¼ í†µí•´ ë°ì´í„° ì €ì¥
				await saveStoreData(storeData);

				// ì¼ì • ì‹œê°„ ëŒ€ê¸° (API í˜¸ì¶œ ê°„ ê°„ê²© ìœ ì§€)
				await new Promise(resolve => setTimeout(resolve, 100));
			}
		}

		//ë°ì´í„° ì €ì¥í•˜ëŠ” í•¨ìˆ˜
		async function saveStoreData(storeData) {
			try {
				const response = await fetch('http://localhost:8080/load/store/save', {
					method: 'POST',
					headers: {
						'Content-Type': 'application/json',
					},
					body: JSON.stringify(storeData),
				});

				if (!response.ok) {
					throw new Error('Failed to save store data');
				}

				const data = await response.json();
				console.log('Store data saved successfully:', data);
			} catch (error) {
				console.error('Error saving store data:', error);
			}
		}
		// ê³ ìœ  ID ì¡´ì¬ ì—¬ë¶€ ì²´í¬ í•¨ìˆ˜ (ì˜ˆì‹œ)
		async function checkIfExists(uniqueId) {
			const response = await fetch(`http://localhost:8080/load/store/save/${uniqueId}`);
			return response.ok; // ì¡´ì¬í•˜ë©´ true ë°˜í™˜
		}


		// ì§€ë„ í‘œì‹œ í•¨ìˆ˜
		function loadNearbyStores() {
			const restaurantList = $('#restaurantList');
			restaurantList.empty(); // ê¸°ì¡´ ë¦¬ìŠ¤íŠ¸ ì œê±°
			// ì‚¬ìš©ìì˜ í˜„ì¬ ìœ„ì¹˜ ê°€ì ¸ì˜¤ê¸°
			navigator.geolocation.getCurrentPosition(position => {
				const {latitude, longitude} = position.coords;

				fetch('/load/store')
					.then(response => {
						if (!response.ok) {
							throw new Error('Network response was not ok');
						}
						return response.json();
					})
					.then(stores => {
						// ì‚¬ìš©ìì˜ ìœ„ì¹˜ ê·¼ì²˜ ê°€ê²Œ í•„í„°ë§ (ì˜ˆ: 5km ì´ë‚´)
						const nearbyStores = stores.filter(store => {

							const distance = calculateDistance(latitude, longitude, store.stoLatitude, store.stoLongitude);
							return distance <= 5; // 5km ì´ë‚´
						});
						displayAllRestaurants(nearbyStores, 1); // ì²« í˜ì´ì§€ í‘œì‹œ

						// ì²« ë²ˆì§¸ ì‹ë‹¹ì— ëŒ€í•´ ì§€ë„ ì´ˆê¸°í™”
						if (nearbyStores.length > 0) {
							initMap(nearbyStores[0].stoLatitude, nearbyStores[0].stoLongitude, nearbyStores[0].stoName);
						}
					})
					.catch(error => console.error('Error fetching stores:', error));
			}, () => {
				console.error('Unable to retrieve location.');
			});
		}

		function loadAllStores(city, district) {
			const restaurantList = $('#restaurantList');
			restaurantList.empty(); // ê¸°ì¡´ ë¦¬ìŠ¤íŠ¸ ì œê±°
			fetch('/load/store')
				.then(response => response.json())
				.then(stores => {
					const filteredStores = stores.filter(store => {
						return store.stoRegionProvince === city && store.stoRegionCity === district;
					});
					displayAllRestaurants(filteredStores, 1); // ì²« í˜ì´ì§€ í‘œì‹œ
				})
				.catch(error => console.error('Error fetching stores:', error));
		}

		function displayAllRestaurants(filteredStores, currentPage) {
			fetch('/load/getUserId') // ì„œë²„ì˜ ì—”ë“œí¬ì¸íŠ¸ë¡œ ìš”ì²­
				.then(response => {
					if (!response.ok) {
						throw new Error('ë„¤íŠ¸ì›Œí¬ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
					}
					return response.json();
				})
				.then(data => {
					const userId = data.userId; // ì„œë²„ì—ì„œ ë°›ì€ UserId
					const restaurantList = $('#restaurantList');
					const itemsPerPage = 5; // í˜ì´ì§€ë‹¹ í•­ëª© ìˆ˜
					const startIndex = (currentPage - 1) * itemsPerPage;
					const endIndex = startIndex + itemsPerPage;
					const paginatedRestaurants = filteredStores.slice(startIndex, endIndex);
					restaurantList.empty(); // ê¸°ì¡´ ë¦¬ìŠ¤íŠ¸ ì œê±°
					if (paginatedRestaurants.length === 0) {
						restaurantList.append('<div>ì‹ë‹¹ì´ ì—†ìŠµë‹ˆë‹¤.</div>');
						return;
					}

					paginatedRestaurants.forEach((store, index) => {
						const {
							stoId,
							stoName,
							stoTitle,
							stoContent,
							stoCategory,
							viewCount,
							recommendationCount,
							stoContact,
							stoAddress,
							stoImage,
							stoOperatingHours,
							stoClosedDays,
							stoRecommendedMenu,
							stoParkingInfo,
							stoLatitude,
							stoLongitude,
							stoVegetarianType,
							stoRegionProvince,
							stoRegionCity,
							kakaoStoreId,
							storeReviews
						} = store;

						const isOpen = checkIfOpen(stoOperatingHours); // ì—¬ê¸°ì„œ isOpen ê°’ì„ ì„¤ì •

						function checkIfOpen(operatingHours) {
							const [openTime, closeTime] = operatingHours.split(' - ');
							const currentTime = new Date();
							const currentHours = currentTime.getHours();
							const currentMinutes = currentTime.getMinutes();

							const [openHours, openMinutes] = openTime.split(':').map(Number);
							const [closeHours, closeMinutes] = closeTime.split(':').map(Number);

							const currentTotalMinutes = currentHours * 60 + currentMinutes;
							const openTotalMinutes = openHours * 60 + openMinutes;
							const closeTotalMinutes = closeHours * 60 + closeMinutes;

							return currentTotalMinutes >= openTotalMinutes && currentTotalMinutes < closeTotalMinutes;
						}

						const storeItem = $(`
                    <div class="restaurant-item" data-lat="${stoLatitude}" data-lng="${stoLongitude}">
                        <p class='solo'>${stoName} - ${stoTitle} </p>
                        <img src="${stoImage}" alt="${stoName}" class='img-fluid'><br>
                        ë‚´ìš©: ${stoContent}<br>
                        ì¹´í…Œê³ ë¦¬: ${stoCategory}<br>
                        ì§€ì—­: ${stoRegionProvince}, ${stoRegionCity}<br>
                        ì „í™”ë²ˆí˜¸: ${stoContact}<br>
                        ì£¼ì†Œ: ${stoAddress}<br>
                        ìš´ì˜ì‹œê°„: ${stoOperatingHours}<br>
                        íœ´ë¬´ì¼: ${stoClosedDays}<br>
                        ì¶”ì²œ ë©”ë‰´: ${stoRecommendedMenu}<br>
                        ì£¼ì°¨ ì •ë³´: ${stoParkingInfo}<br>
                        ì±„ì‹ ì¢…ë¥˜: ${stoVegetarianType}<br>
                        ì¡°íšŒìˆ˜: ${viewCount}<br>
                        ë¦¬ë·°ìˆ˜ : ${storeReviews.length}<br>
                        ì¶”ì²œ í‰ì : ${recommendationCount}<br>
                        ì¹´ì¹´ì˜¤ ID: ${kakaoStoreId}<br>
                        ìƒíƒœ: ${isOpen ? 'ì˜ì—…ì¤‘' : 'ì˜ì—…ì¢…ë£Œ'}<br>
                        <a href="http://localhost:8080/load/place/${stoId}" class="my-2 btn btn-info">ìì„¸íˆë³´ê¸°</a>
						<span class='mx-3 btn btn-warning' onclick="addFavorite('${userId}', ${stoId})">ì°œğŸ‘</span>
                    </div>
                `);

						restaurantList.append(storeItem);

						storeItem.on('click', function () {
							$('.restaurant-item').removeClass('expanded'); // ëª¨ë“  í•­ëª© í´ë˜ìŠ¤ ì œê±°
							$(this).addClass('expanded'); // í´ë¦­í•œ í•­ëª©ì— í´ë˜ìŠ¤ ì¶”ê°€
							initMap(stoLatitude, stoLongitude, stoName); // ì§€ë„ ì´ˆê¸°í™”
						});
					});

					// ê¸°ë³¸ì ìœ¼ë¡œ ì²« ë²ˆì§¸ í•­ëª© í™•ì¥
					if (paginatedRestaurants.length > 0) {
						const firstItem = $('.restaurant-item').first();
						firstItem.addClass('expanded');
						initMap(firstItem.data('lat'), firstItem.data('lng'), firstItem.find('.solo').text()); // ì´ˆê¸° ì§€ë„ ì„¤ì •
					}

					setupPagination(filteredStores.length, itemsPerPage, filteredStores); // í˜ì´ì§€ë„¤ì´ì…˜ ì„¤ì •
				})
				.catch(error => console.error('Error:', error));
		}


		//í˜ì´ì§€ë„¤ì´ì…˜ ì„¤ì • í•¨ìˆ˜
		function setupPagination(totalItems, itemsPerPage, filteredStores) {
			const pagination = $('#pagination');
			pagination.empty(); // ê¸°ì¡´ í˜ì´ì§€ë„¤ì´ì…˜ ì œê±°
			const totalPages = Math.ceil(totalItems / itemsPerPage); // ì´ í˜ì´ì§€ ìˆ˜

			for (let i = 1; i <= totalPages; i++) {
				const pageButton = $('<button>').text(i).on('click', function () {
					itemsPerPage = i; // í´ë¦­í•œ í˜ì´ì§€ë¡œ ì´ë™
					displayAllRestaurants(filteredStores, itemsPerPage); // í•´ë‹¹ í˜ì´ì§€ì˜ ì‹ë‹¹ ë¦¬ìŠ¤íŠ¸ í‘œì‹œ
				});

				if (i === itemsPerPage) {
					pageButton.addClass('active');
				}

				pagination.append(pageButton);
			}
		}
		// ê±°ë¦¬ ê³„ì‚° í•¨ìˆ˜
		function calculateDistance(lat1, lon1, lat2, lon2) {
			const R = 6371; // ì§€êµ¬ ë°˜ì§€ë¦„ (í‚¬ë¡œë¯¸í„°)
			const dLat = (lat2 - lat1) * Math.PI / 180;
			const dLon = (lon2 - lon1) * Math.PI / 180;
			const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +
				Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
				Math.sin(dLon / 2) * Math.sin(dLon / 2);
			const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
			return R * c; // ê±°ë¦¬ ë°˜í™˜ (í‚¬ë¡œë¯¸í„°)
		}

		// í˜ì´ì§€ ë¡œë“œ ì‹œ ì‚¬ìš©ìì˜ ìœ„ì¹˜ ê·¼ì²˜ ê°€ê²Œ ë¡œë“œ
		$(document).ready(() => {
			loadNearbyStores(); // í™ˆí˜ì´ì§€ ë¡œë“œ ì‹œ ì‚¬ìš©ì ìœ„ì¹˜ ê·¼ì²˜ ê°€ê²Œ ë¡œë“œ
		});

		function initMap(lat, lng, placeName) {
			const mapContainer = document.getElementById('map');
			const mapOption = {
				center: new kakao.maps.LatLng(lat, lng),
				level: 5 // ì§€ë„ì˜ í™•ëŒ€ ìˆ˜ì¤€
			};
			const map = new kakao.maps.Map(mapContainer, mapOption);

			// ë§ˆì»¤ ì¶”ê°€
			const markerPosition = new kakao.maps.LatLng(lat, lng);
			const marker = new kakao.maps.Marker({
				position: markerPosition,
				title: placeName // ë§ˆì»¤ì— ì‹ë‹¹ ì´ë¦„ ì¶”ê°€
			});
			marker.setMap(map); // ë§ˆì»¤ë¥¼ ì§€ë„ì— í‘œì‹œ

			// InfoWindow ì¶”ê°€
			const infowindow = new kakao.maps.InfoWindow({
				content: `<div style="padding:5px;">${placeName}</div>`, // InfoWindowì— í‘œì‹œí•  ë‚´ìš©
				removable: true // ë‹«ê¸° ë²„íŠ¼ì„ ì¶”ê°€
			});
			infowindow.open(map, marker); // ë§ˆì»¤ ìœ„ì— InfoWindow í‘œì‹œ
		}

		function addFavorite(memberId, stoId) {
			console.log('memberId:', memberId); // ë””ë²„ê¹…ìš© ì¶œë ¥
			console.log('stoId:', stoId); // ë””ë²„ê¹…ìš© ì¶œë ¥
			fetch(`/store/favorite/add?memberId=${memberId}&stoId=${stoId}`, { // ì„œë²„ì˜ API ì—”ë“œí¬ì¸íŠ¸
				method: 'POST',
				headers: {
					'Content-Type': 'application/json',
				},
				body: JSON.stringify({memberId: memberId, stoId: stoId})
			})
				.then(response => {
					if (response.ok) {
						alert('ì°œí•˜ê¸°ì— ì„±ê³µí–ˆìŠµë‹ˆë‹¤!');
					} else {
						return response.text().then(text => {
							if (text === "ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”") {
								alert(text);
								// ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
								window.location.href = 'http://localhost:8080/member/login'; // ë¡œê·¸ì¸ í˜ì´ì§€ URLë¡œ ìˆ˜ì •
							} else {
								alert(text); // ë‹¤ë¥¸ ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ
							}
						});
					}
				})
				.catch(error => {
					console.error('Error:', error);
					alert('ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
				});
		}
	</script>
</div>

</html>