<html layout:decorate="~{layout}">
<div layout:fragment="content" class="container-fluid">
	<link rel="stylesheet" href="/css/map.css" />
	<link rel="stylesheet"
		href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css">
	<script
		src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>
	<!-- í•œê¸€ ì–¸ì–´ íŒŒì¼ ì¶”ê°€ -->
	<script
		src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/locales/bootstrap-datepicker.kr.min.js"></script>

	<!-- Tempus Dominus (ë‹¤ë¥¸ ë‚ ì§œ ì„ íƒê¸°) ê´€ë ¨ ë§í¬ëŠ” í•„ìš”ì— ë”°ë¼ ìœ ì§€ -->
	<link rel="stylesheet"
		href="https://cdnjs.cloudflare.com/ajax/libs/tempusdominus-bootstrap-4/5.39.0/css/tempusdominus-bootstrap-4.min.css" />
	<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
	<script
		src="https://cdnjs.cloudflare.com/ajax/libs/tempusdominus-bootstrap-4/5.39.0/js/tempusdominus-bootstrap-4.min.js"></script>

	<div class="searchWrapper bg-light">
		<div class="selectRegion ">
			<div class="searchBox">
				<input type="text" class="search-input" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." id="searchInput">
				<svg xmlns="http://www.w3.org/2000/svg" class="search-icon" viewBox="0 0 16 16">
					<path
						d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0" />
				</svg>
			</div>
			<div id="results"></div> <!-- ê²€ìƒ‰ ê²°ê³¼ë¥¼ í‘œì‹œí•  ì˜ì—­ -->

			<h5 class="selectRegionForm border-bottom p-3">
				<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="#6a994e"
					class="bi bi-globe-asia-australia" viewBox="0 0 16 16">
					<path
						d="m10.495 6.92 1.278-.619a.483.483 0 0 0 .126-.782c-.252-.244-.682-.139-.932.107-.23.226-.513.373-.816.53l-.102.054c-.338.178-.264.626.1.736a.48.48 0 0 0 .346-.027ZM7.741 9.808V9.78a.413.413 0 1 1 .783.183l-.22.443a.6.6 0 0 1-.12.167l-.193.185a.36.36 0 1 1-.5-.516l.112-.108a.45.45 0 0 0 .138-.326M5.672 12.5l.482.233A.386.386 0 1 0 6.32 12h-.416a.7.7 0 0 1-.419-.139l-.277-.206a.302.302 0 1 0-.298.52z" />
					<path
						d="M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0M1.612 10.867l.756-1.288a1 1 0 0 1 1.545-.225l1.074 1.005a.986.986 0 0 0 1.36-.011l.038-.037a.88.88 0 0 0 .26-.755c-.075-.548.37-1.033.92-1.099.728-.086 1.587-.324 1.728-.957.086-.386-.114-.83-.361-1.2-.207-.312 0-.8.374-.8.123 0 .24-.055.318-.15l.393-.474c.196-.237.491-.368.797-.403.554-.064 1.407-.277 1.583-.973.098-.391-.192-.634-.484-.88-.254-.212-.51-.426-.515-.741a7 7 0 0 1 3.425 7.692 1 1 0 0 0-.087-.063l-.316-.204a1 1 0 0 0-.977-.06l-.169.082a1 1 0 0 1-.741.051l-1.021-.329A1 1 0 0 0 11.205 9h-.165a1 1 0 0 0-.945.674l-.172.499a1 1 0 0 1-.404.514l-.802.518a1 1 0 0 0-.458.84v.455a1 1 0 0 0 1 1h.257a1 1 0 0 1 .542.16l.762.49a1 1 0 0 0 .283.126 7 7 0 0 1-9.49-3.409Z" />
				</svg>
				ì§€ì—­ë³„ ê°€ê²Œ ë³´ê¸°
			</h5>
			<form class="selectRegionForm border-bottom p-3">
				<label for="city">ì‹œ/ë„ ì„ íƒ:</label>
				<select id="city">
					<option value="">ì„ íƒí•˜ì„¸ìš”</option>
					<option value="ì„œìš¸">ì„œìš¸</option>
					<option value="ë¶€ì‚°">ë¶€ì‚°</option>
					<option value="ëŒ€êµ¬">ëŒ€êµ¬</option>
					<option value="ì¸ì²œ">ì¸ì²œ</option>
					<option value="ê´‘ì£¼">ê´‘ì£¼</option>
					<option value="ëŒ€ì „">ëŒ€ì „</option>
					<option value="ìš¸ì‚°">ìš¸ì‚°</option>
					<option value="ì„¸ì¢…">ì„¸ì¢…</option>
					<option value="ê²½ê¸°">ê²½ê¸°</option>
					<option value="ê°•ì›">ê°•ì›</option>
					<option value="ì¶©ë¶">ì¶©ë¶</option>
					<option value="ì¶©ë‚¨">ì¶©ë‚¨</option>
					<option value="ì „ë¶">ì „ë¶</option>
					<option value="ì „ë‚¨">ì „ë‚¨</option>
					<option value="ê²½ë¶">ê²½ë¶</option>
					<option value="ê²½ë‚¨">ê²½ë‚¨</option>
					<option value="ì œì£¼">ì œì£¼</option>
				</select>
				<br />
				<label for="district" class="mt-2">êµ¬ ì„ íƒ:</label>
				<select id="district" disabled>
					<option value="">ì‹œ/ë„ë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
				</select>

			</form>
		</div>
		<div class="hideBtn">
			<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor"
				class="bi bi-arrow-down-circle" viewBox="0 0 16 16">
				<path fill-rule="evenodd"
					d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8m15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0M8.5 4.5a.5.5 0 0 0-1 0v5.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293z" />
			</svg>
		</div>
		<div id="restaurantList">
			<p class="noSelect alert text-center">
				<span>ì§€ì—­ì„ ì„ íƒí•´ì£¼ì„¸ìš”</span>
			</p>
		</div>
		<div id="pagination" class="my-2"></div>

	</div>
	<div class="mapWrapper">
		<div id="map">
			<button id="zoomIn">+</button>
			<button id="zoomOut">-</button>
			<button id="location"> <span title="í˜„ì¬ ìœ„ì¹˜" class="getUserLocationBtn"><img
						src="/imgs/map/my_location_30dp_5F6368_FILL0_wght400_GRAD0_opsz24.svg" alt="" /></span></button>
		</div>

	</div>
	<script>
		const districts = {
			ì„œìš¸: {
				coords: {lat: 37.5665, lng: 126.978},
				districts: {
					"ê°•ë‚¨êµ¬": {coords: {lat: 37.5172, lng: 127.0473}},
					"ê°•ë™êµ¬": {coords: {lat: 37.5303, lng: 127.1238}},
					"ê°•ë¶êµ¬": {coords: {lat: 37.6398, lng: 127.0255}},
					"ê´€ì•…êµ¬": {coords: {lat: 37.4783, lng: 126.9512}},
					"êµ¬ë¡œêµ¬": {coords: {lat: 37.4955, lng: 126.8832}},
					"ê¸ˆì²œêµ¬": {coords: {lat: 37.4545, lng: 126.9005}},
					"ë…¸ì›êµ¬": {coords: {lat: 37.6550, lng: 127.0565}},
					"ë„ë´‰êµ¬": {coords: {lat: 37.6684, lng: 127.0288}},
					"ë™ëŒ€ë¬¸êµ¬": {coords: {lat: 37.5744, lng: 127.0422}},
					"ë™ì‘êµ¬": {coords: {lat: 37.5045, lng: 126.9515}},
					"ë§ˆí¬êµ¬": {coords: {lat: 37.5482, lng: 126.9033}},
					"ì„œëŒ€ë¬¸êµ¬": {coords: {lat: 37.5793, lng: 126.9655}},
					"ì„œì´ˆêµ¬": {coords: {lat: 37.4839, lng: 127.0324}},
					"ì„±ë™êµ¬": {coords: {lat: 37.5636, lng: 127.0428}},
					"ì„±ë¶êµ¬": {coords: {lat: 37.5890, lng: 127.0170}},
					"ì†¡íŒŒêµ¬": {coords: {lat: 37.5049, lng: 127.1149}},
					"ì–‘ì²œêµ¬": {coords: {lat: 37.5162, lng: 126.8660}},
					"ì˜ë“±í¬êµ¬": {coords: {lat: 37.5260, lng: 126.8958}},
					"ìš©ì‚°êµ¬": {coords: {lat: 37.5326, lng: 126.9905}},
					"ì€í‰êµ¬": {coords: {lat: 37.6090, lng: 126.9345}},
					"ì¢…ë¡œêµ¬": {coords: {lat: 37.5700, lng: 126.9980}},
					"ì¤‘êµ¬": {coords: {lat: 37.5636, lng: 126.9970}},
					"ì¤‘ë‘êµ¬": {coords: {lat: 37.6060, lng: 127.0920}}
				}
			},
			ë¶€ì‚°: {
				coords: {lat: 35.1796, lng: 129.0756},
				districts: {
					"ê°•ì„œêµ¬": {coords: {lat: 35.1744, lng: 128.9470}},
					"ê¸ˆì •êµ¬": {coords: {lat: 35.2280, lng: 129.0790}},
					"ê¸°ì¥êµ°": {coords: {lat: 35.2390, lng: 129.2270}},
					"ë‚¨êµ¬": {coords: {lat: 35.1460, lng: 129.1000}},
					"ë™êµ¬": {coords: {lat: 35.0660, lng: 129.0400}},
					"ë¶€ì‚°ì§„êµ¬": {coords: {lat: 35.1595, lng: 129.0594}},
					"ë¶êµ¬": {coords: {lat: 35.2000, lng: 129.0010}},
					"ì‚¬ìƒêµ¬": {coords: {lat: 35.1440, lng: 128.9790}},
					"ì‚¬í•˜êµ¬": {coords: {lat: 35.0960, lng: 128.9790}},
					"ì„œêµ¬": {coords: {lat: 35.0960, lng: 129.0140}},
					"ìˆ˜ì˜êµ¬": {coords: {lat: 35.1580, lng: 129.1160}},
					"ì—°ì œêµ¬": {coords: {lat: 35.1790, lng: 129.0860}},
					"ì˜ë„êµ¬": {coords: {lat: 35.0660, lng: 129.1000}},
					"ì¤‘êµ¬": {coords: {lat: 35.1130, lng: 129.0400}}
				}
			},
			ëŒ€êµ¬: {
				coords: {lat: 35.8714, lng: 128.6014},
				districts: {
					"ë‚¨êµ¬": {coords: {lat: 35.8450, lng: 128.6010}},
					"ë‹¬ì„œêµ¬": {coords: {lat: 35.8350, lng: 128.5800}},
					"ë‹¬ì„±êµ°": {coords: {lat: 35.7070, lng: 128.4870}},
					"ë™êµ¬": {coords: {lat: 35.8700, lng: 128.6100}},
					"ë¶êµ¬": {coords: {lat: 35.8950, lng: 128.6000}},
					"ì„œêµ¬": {coords: {lat: 35.8700, lng: 128.5500}},
					"ìˆ˜ì„±êµ¬": {coords: {lat: 35.8460, lng: 128.6100}},
					"ì¤‘êµ¬": {coords: {lat: 35.8700, lng: 128.6000}}
				}
			},
			ì¸ì²œ: {
				coords: {lat: 37.4563, lng: 126.7052},
				districts: {
					"ê°•í™”êµ°": {coords: {lat: 37.7030, lng: 126.4870}},
					"ê³„ì–‘êµ¬": {coords: {lat: 37.5160, lng: 126.7250}},
					"ë‚¨ë™êµ¬": {coords: {lat: 37.4480, lng: 126.7240}},
					"ë™êµ¬": {coords: {lat: 37.4870, lng: 126.6170}},
					"ë¯¸ì¶”í™€êµ¬": {coords: {lat: 37.4630, lng: 126.6340}},
					"ë¶€í‰êµ¬": {coords: {lat: 37.5070, lng: 126.7240}},
					"ì„œêµ¬": {coords: {lat: 37.4870, lng: 126.6500}},
					"ì—°ìˆ˜êµ¬": {coords: {lat: 37.4480, lng: 126.6830}},
					"ì˜¹ì§„êµ°": {coords: {lat: 37.5000, lng: 126.5000}},
					"ì¤‘êµ¬": {coords: {lat: 37.4630, lng: 126.6500}}
				}
			},
			ê´‘ì£¼: {
				coords: {lat: 35.1595, lng: 126.8526},
				districts: {
					"ê´‘ì‚°êµ¬": {coords: {lat: 35.1890, lng: 126.8450}},
					"ë‚¨êµ¬": {coords: {lat: 35.1450, lng: 126.8500}},
					"ë™êµ¬": {coords: {lat: 35.1570, lng: 126.8500}},
					"ë¶êµ¬": {coords: {lat: 35.1740, lng: 126.8500}},
					"ì„œêµ¬": {coords: {lat: 35.1550, lng: 126.8500}}
				}
			},
			ëŒ€ì „: {
				coords: {lat: 36.3504, lng: 127.3845},
				districts: {
					"ëŒ€ë•êµ¬": {coords: {lat: 36.3730, lng: 127.3960}},
					"ë™êµ¬": {coords: {lat: 36.3470, lng: 127.3920}},
					"ì„œêµ¬": {coords: {lat: 36.3530, lng: 127.3850}},
					"ìœ ì„±êµ¬": {coords: {lat: 36.3660, lng: 127.3660}},
					"ì¤‘êµ¬": {coords: {lat: 36.3480, lng: 127.3840}}
				}
			},
			ìš¸ì‚°: {
				coords: {lat: 35.5384, lng: 129.3114},
				districts: {
					"ë‚¨êµ¬": {coords: {lat: 35.5250, lng: 129.3000}},
					"ë™êµ¬": {coords: {lat: 35.5500, lng: 129.3000}},
					"ë¶êµ¬": {coords: {lat: 35.5700, lng: 129.3000}},
					"ìš¸ì£¼êµ°": {coords: {lat: 35.5400, lng: 129.3000}},
					"ì¤‘êµ¬": {coords: {lat: 35.5300, lng: 129.3000}}
				}
			},
			ì„¸ì¢…: {
				coords: {lat: 36.4802, lng: 127.2895},
				districts: {
					"ì„¸ì¢…ì‹œ": {coords: {lat: 36.4802, lng: 127.2895}}
				}
			},
			ê²½ê¸°: {
				coords: {lat: 37.4138, lng: 127.5183},
				districts: {
					"ê°€í‰êµ°": {coords: {lat: 37.8340, lng: 127.4870}},
					"ê³ ì–‘ì‹œ": {coords: {lat: 37.6700, lng: 126.8300}},
					"ê³¼ì²œì‹œ": {coords: {lat: 37.4780, lng: 126.9890}},
					"ê´‘ëª…ì‹œ": {coords: {lat: 37.4780, lng: 126.9000}},
					"ê´‘ì£¼ì‹œ": {coords: {lat: 37.3980, lng: 127.2530}},
					"êµ¬ë¦¬ì‹œ": {coords: {lat: 37.6000, lng: 127.1300}},
					"êµ°í¬ì‹œ": {coords: {lat: 37.3590, lng: 126.9500}},
					"ê¹€í¬ì‹œ": {coords: {lat: 37.6160, lng: 126.6500}},
					"ë‚¨ì–‘ì£¼ì‹œ": {coords: {lat: 37.6350, lng: 127.2000}},
					"ë™ë‘ì²œì‹œ": {coords: {lat: 37.9010, lng: 127.0600}},
					"ë¶€ì²œì‹œ": {coords: {lat: 37.4870, lng: 126.7830}},
					"ì„±ë‚¨ì‹œ": {coords: {lat: 37.4400, lng: 127.1280}},
					"ìˆ˜ì›ì‹œ": {coords: {lat: 37.2630, lng: 127.0280}},
					"ì‹œí¥ì‹œ": {coords: {lat: 37.3830, lng: 126.8000}},
					"ì•ˆì‚°ì‹œ": {coords: {lat: 37.3190, lng: 126.8300}},
					"ì•ˆì„±ì‹œ": {coords: {lat: 37.0050, lng: 127.2770}},
					"ì–‘ì£¼ì‹œ": {coords: {lat: 37.8000, lng: 127.0500}},
					"ì–‘í‰êµ°": {coords: {lat: 37.5000, lng: 127.5000}},
					"ì—¬ì£¼ì‹œ": {coords: {lat: 37.3000, lng: 127.4000}},
					"ì˜¤ì‚°ì‹œ": {coords: {lat: 37.1500, lng: 127.0500}},
					"ìš©ì¸ì‹œ": {coords: {lat: 37.2410, lng: 127.1770}},
					"ì˜ì™•ì‹œ": {coords: {lat: 37.3350, lng: 126.9930}},
					"ì˜ì •ë¶€ì‹œ": {coords: {lat: 37.7380, lng: 127.0500}},
					"ì´ì²œì‹œ": {coords: {lat: 37.2800, lng: 127.4500}},
					"íŒŒì£¼ì‹œ": {coords: {lat: 37.7590, lng: 126.7700}},
					"í‰íƒì‹œ": {coords: {lat: 37.0730, lng: 127.1000}},
					"í•˜ë‚¨ì‹œ": {coords: {lat: 37.5450, lng: 127.2000}},
					"í™”ì„±ì‹œ": {coords: {lat: 37.2050, lng: 126.8000}}
				}
			},
			ê°•ì›: {
				coords: {lat: 37.8228, lng: 128.1555},
				districts: {
					"ê°•ë¦‰ì‹œ": {coords: {lat: 37.7510, lng: 128.8760}},
					"ê³ ì„±êµ°": {coords: {lat: 38.2000, lng: 128.6000}},
					"ë™í•´ì‹œ": {coords: {lat: 37.5080, lng: 128.8950}},
					"ì‚¼ì²™ì‹œ": {coords: {lat: 37.4480, lng: 129.1640}},
					"ì†ì´ˆì‹œ": {coords: {lat: 38.2070, lng: 128.5910}},
					"ì–‘êµ¬êµ°": {coords: {lat: 38.1000, lng: 128.5000}},
					"ì–‘ì–‘êµ°": {coords: {lat: 38.0660, lng: 128.6170}},
					"ì˜ì›”êµ°": {coords: {lat: 37.1740, lng: 127.6000}},
					"ì›ì£¼ì‹œ": {coords: {lat: 37.3470, lng: 127.9200}},
					"ì² ì›êµ°": {coords: {lat: 38.2000, lng: 127.3000}},
					"ì¶˜ì²œì‹œ": {coords: {lat: 37.8830, lng: 127.7300}},
					"íƒœë°±ì‹œ": {coords: {lat: 37.1500, lng: 128.9960}},
					"í‰ì°½êµ°": {coords: {lat: 37.3660, lng: 128.4000}},
					"í™ì²œêµ°": {coords: {lat: 37.7000, lng: 127.8000}},
					"í™”ì²œêµ°": {coords: {lat: 38.1000, lng: 127.5000}},
					"íš¡ì„±êµ°": {coords: {lat: 37.3000, lng: 127.6000}}
				}
			},
			ì¶©ë¶: {
				coords: {lat: 36.6359, lng: 127.4914},
				districts: {
					"ê´´ì‚°êµ°": {coords: {lat: 36.7400, lng: 137.0000}},
					"ë‹¨ì–‘êµ°": {coords: {lat: 36.9990, lng: 128.3000}},
					"ë³´ì€êµ°": {coords: {lat: 36.5000, lng: 127.7000}},
					"ì˜ë™êµ°": {coords: {lat: 36.3000, lng: 127.5000}},
					"ì˜¥ì²œêµ°": {coords: {lat: 36.5000, lng: 127.4000}},
					"ìŒì„±êµ°": {coords: {lat: 36.5000, lng: 127.6000}},
					"ì œì²œì‹œ": {coords: {lat: 37.1500, lng: 128.2000}},
					"ì²­ì£¼ì‹œ": {coords: {lat: 36.6500, lng: 127.5000}},
					"ì¶©ì£¼ì‹œ": {coords: {lat: 36.9500, lng: 127.4000}}
				}
			},
			ì¶©ë‚¨: {
				coords: {lat: 36.6359, lng: 126.6772},
				districts: {
					"ê³„ë£¡ì‹œ": {coords: {lat: 36.3000, lng: 127.1000}},
					"ê³µì£¼ì‹œ": {coords: {lat: 36.5000, lng: 127.2000}},
					"ë…¼ì‚°ì‹œ": {coords: {lat: 36.2000, lng: 127.3000}},
					"ë‹¹ì§„ì‹œ": {coords: {lat: 36.8000, lng: 126.7000}},
					"ë³´ë ¹ì‹œ": {coords: {lat: 36.3000, lng: 126.6000}},
					"ì„œì‚°ì‹œ": {coords: {lat: 36.7000, lng: 126.5000}},
					"ì•„ì‚°ì‹œ": {coords: {lat: 36.5000, lng: 126.8000}},
					"ì²œì•ˆì‹œ": {coords: {lat: 36.8000, lng: 127.0000}},
					"ì²­ì–‘êµ°": {coords: {lat: 36.5000, lng: 126.8000}},
					"íƒœì•ˆêµ°": {coords: {lat: 36.5000, lng: 126.3000}},
					"í™ì„±êµ°": {coords: {lat: 36.5000, lng: 126.6000}}
				}
			},
			ì „ë¶: {
				coords: {lat: 35.7194, lng: 127.1445},
				districts: {
					"ê³ ì°½êµ°": {coords: {lat: 35.4000, lng: 126.7000}},
					"êµ°ì‚°ì‹œ": {coords: {lat: 35.9650, lng: 126.7300}},
					"ê¹€ì œì‹œ": {coords: {lat: 35.8000, lng: 126.9000}},
					"ë‚¨ì›ì‹œ": {coords: {lat: 35.4000, lng: 127.4000}},
					"ìµì‚°ì‹œ": {coords: {lat: 35.9500, lng: 126.8000}},
					"ì „ì£¼ì‹œ": {coords: {lat: 35.8000, lng: 127.1500}},
					"ì •ìì‹œ": {coords: {lat: 35.5700, lng: 126.8500}},
					"ì™„ì£¼êµ°": {coords: {lat: 35.8000, lng: 127.2000}},
					"ì„ì‹¤êµ°": {coords: {lat: 35.5000, lng: 127.3000}},
					"ì¥ìˆ˜êµ°": {coords: {lat: 35.6000, lng: 127.5000}},
					"ì§„ì•ˆêµ°": {coords: {lat: 35.7000, lng: 127.3000}}
				}
			},
			ì „ë‚¨: {
				coords: {lat: 34.8144, lng: 126.4633},
				districts: {
					"ê°•ì§„êµ°": {coords: {lat: 34.6000, lng: 126.7000}},
					"ê³ í¥êµ°": {coords: {lat: 34.6000, lng: 126.5000}},
					"ê³¡ì„±êµ°": {coords: {lat: 35.0000, lng: 127.0000}},
					"ê´‘ì–‘ì‹œ": {coords: {lat: 34.9500, lng: 127.7000}},
					"êµ¬ë¡€êµ°": {coords: {lat: 35.2000, lng: 127.6000}},
					"ë‚˜ì£¼": {coords: {lat: 35.0000, lng: 126.8000}},
					"ë‹´ì–‘êµ°": {coords: {lat: 35.3000, lng: 126.8000}},
					"ëª©í¬ì‹œ": {coords: {lat: 34.8000, lng: 126.4000}},
					"ë¬´ì•ˆêµ°": {coords: {lat: 34.8000, lng: 126.6000}},
					"ë³´ì„±êµ°": {coords: {lat: 34.8000, lng: 127.0000}},
					"ì‹ ì•ˆêµ°": {coords: {lat: 34.6000, lng: 126.3000}},
					"ì—¬ìˆ˜ì‹œ": {coords: {lat: 34.7500, lng: 127.7000}},
					"ì˜ê´‘êµ°": {coords: {lat: 35.2000, lng: 126.6000}},
					"ì˜ì•”êµ°": {coords: {lat: 34.8000, lng: 126.6000}},
					"ì™„ë„êµ°": {coords: {lat: 34.3000, lng: 126.7000}},
					"ì¥ì„±êµ°": {coords: {lat: 35.3000, lng: 126.8000}},
					"ì¥í¥êµ°": {coords: {lat: 34.6000, lng: 126.5000}},
					"ì§„ë„êµ°": {coords: {lat: 34.5000, lng: 126.3000}},
					"í•¨í‰êµ°": {coords: {lat: 35.0000, lng: 126.5000}},
					"í•´ë‚¨êµ°": {coords: {lat: 34.5000, lng: 126.5000}},
					"í™”ìˆœêµ°": {coords: {lat: 35.0000, lng: 126.7000}}
				}
			},
			ê²½ë¶: {
				coords: {lat: 36.4911, lng: 128.8889},
				districts: {
					"ê²½ì‚°ì‹œ": {coords: {lat: 35.8000, lng: 128.7000}},
					"ê²½ì£¼": {coords: {lat: 35.8500, lng: 129.2000}},
					"ê³ ë ¹êµ°": {coords: {lat: 35.6000, lng: 128.4000}},
					"êµ¬ë¯¸ì‹œ": {coords: {lat: 36.1000, lng: 128.3000}},
					"ê¹€ì²œì‹œ": {coords: {lat: 35.7000, lng: 128.1000}},
					"ë¬¸ê²½ì‹œ": {coords: {lat: 36.5700, lng: 128.3000}},
					"ìƒì£¼": {coords: {lat: 36.4000, lng: 128.2000}},
					"ì„±ì£¼êµ°": {coords: {lat: 35.8000, lng: 128.5000}},
					"ì•ˆë™ì‹œ": {coords: {lat: 36.5600, lng: 128.7000}},
					"ì˜ì£¼": {coords: {lat: 36.8000, lng: 128.6000}},
					"ì˜ì²œì‹œ": {coords: {lat: 35.9000, lng: 128.8000}},
					"ì˜ˆì²œêµ°": {coords: {lat: 36.5000, lng: 128.3000}},
					"ìš¸ë¦‰êµ°": {coords: {lat: 37.5000, lng: 130.8000}},
					"ìš¸ì§„êµ°": {coords: {lat: 36.9000, lng: 129.4000}},
					"í¬í•­ì‹œ": {coords: {lat: 36.0200, lng: 129.3500}}
				}
			},
			ê²½ë‚¨: {
				coords: {lat: 35.2345, lng: 128.6922},
				districts: {
					"ê±°ì œì‹œ": {coords: {lat: 34.9000, lng: 128.6000}},
					"ê±°ì°½êµ°": {coords: {lat: 35.6000, lng: 127.9000}},
					"ê³ ì„±êµ°": {coords: {lat: 35.2000, lng: 128.5000}},
					"ê¹€í•´ì‹œ": {coords: {lat: 35.2000, lng: 128.8000}},
					"ë‚¨í•´êµ°": {coords: {lat: 34.8000, lng: 128.4000}},
					"ë°€ì–‘ì‹œ": {coords: {lat: 35.5000, lng: 128.7000}},
					"ì‚¬ì²œì‹œ": {coords: {lat: 35.0000, lng: 128.6000}},
					"ì‚°ì²­êµ°": {coords: {lat: 35.3000, lng: 127.8000}},
					"ì–‘ì‚°ì‹œ": {coords: {lat: 35.3000, lng: 129.0000}},
					"ì˜ë ¹êµ°": {coords: {lat: 35.3000, lng: 128.5000}},
					"ì§„ì£¼": {coords: {lat: 35.2000, lng: 128.1000}},
					"ì°½ë…•êµ°": {coords: {lat: 35.3000, lng: 128.4000}},
					"ì°½ì›ì‹œ": {coords: {lat: 35.2000, lng: 128.6000}},
					"í†µì˜ì‹œ": {coords: {lat: 34.8000, lng: 128.4000}}
				}
			},
			ì œì£¼: {
				coords: {lat: 33.4996, lng: 126.5312},
				districts: {
					"ì„œê·€í¬ì‹œ": {coords: {lat: 33.2540, lng: 126.5600}},
					"ì œì£¼ì‹œ": {coords: {lat: 33.4996, lng: 126.5312}}
				}
			}
		};

		$(document).ready(function () {
			//ëª¨ë°”ì¼ í™”ë©´ í¬ê¸°
			$(".hideBtn").data("expanded", false); // ì´ˆê¸° ìƒíƒœ ì„¤ì •

			$(".hideBtn").click(function () {
				const searchWrapper = $(".searchWrapper");
				const isExpanded = $(this).data("expanded"); // í˜„ì¬ ìƒíƒœ ê°€ì ¸ì˜¤ê¸°

				if (isExpanded) {
					searchWrapper.css("height", "20%"); // ë†’ì´ë¥¼ 20%ë¡œ ì„¤ì •
					$(this).css("transform", "rotate(0deg)"); // ì•„ì´ì½˜ ì›ë˜ ë°©í–¥
				} else {
					searchWrapper.css("height", "85%"); // ë†’ì´ë¥¼ 80%ë¡œ ì„¤ì •
					$(this).css("transform", "rotate(180deg)"); // ì•„ì´ì½˜ ë°˜ì „
				}

				// ìƒíƒœ í† ê¸€
				$(this).data("expanded", !isExpanded);
			});

			fetchStores();

			//ëª¨ë“  ê°€ê²Œ í‘œì‹œ
			function displayStoresOnMap(allStores) {
				const mapContainer = document.getElementById('map');
				const mapOption = {
					center: new kakao.maps.LatLng(allStores[0].stoLatitude, allStores[0].stoLongitude), // ì²« ë²ˆì§¸ ê°€ê²Œ ìœ„ì¹˜ë¡œ ì¤‘ì‹¬ ì„¤ì •
					level: 6 // ì´ˆê¸° í™•ëŒ€ ìˆ˜ì¤€
				};
				const map = new kakao.maps.Map(mapContainer, mapOption);

				let currentOverlay = null; // í˜„ì¬ ì—´ë ¤ ìˆëŠ” Custom Overlayë¥¼ ì €ì¥í•  ë³€ìˆ˜

				// ì‚¬ìš©ì ì •ì˜ í™•ëŒ€/ì¶•ì†Œ ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
				document.getElementById('zoomIn').addEventListener('click', function () {
					map.setLevel(map.getLevel() - 1); // í™•ëŒ€
				});

				document.getElementById('zoomOut').addEventListener('click', function () {
					map.setLevel(map.getLevel() + 1); // ì¶•ì†Œ
				});
				// ëª¨ë“  ê°€ê²Œì— ëŒ€í•´ ë§ˆì»¤ ì¶”ê°€
				allStores.forEach(store => {
					const markerPosition = new kakao.maps.LatLng(store.stoLatitude, store.stoLongitude);
					const marker = new kakao.maps.Marker({
						position: markerPosition
					});
					marker.setMap(map); // ë§ˆì»¤ë¥¼ ì§€ë„ì— í‘œì‹œ

					// Custom Overlay ì¶”ê°€
					const customOverlay = new kakao.maps.CustomOverlay({
						content: `
					        <div class='infowindowBox'>
					            <span class='closeBtn' onclick='this.parentElement.parentElement.style.display="none"'>âœ–</span>
					            <div style='font-size: 16px; color: #333;'>${store.stoName}</div>
					            <button id="viewDetailsButton" class='btn btn-success'>ìì„¸íˆ ë³´ê¸°</button> <!-- ë²„íŠ¼ ID ì¶”ê°€ -->
					        </div>`,
						position: markerPosition // Overlay ìœ„ì¹˜ ì„¤ì •
					});

					// ë§ˆì»¤ í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€
					kakao.maps.event.addListener(marker, 'click', function () {
						// í˜„ì¬ ì—´ë ¤ ìˆëŠ” Overlayê°€ ìˆë‹¤ë©´ ë‹«ê¸°
						if (currentOverlay) {
							currentOverlay.setMap(null);
						}
						// ìƒˆ Custom Overlay ì—´ê¸°
						customOverlay.setMap(map);
						currentOverlay = customOverlay; // í˜„ì¬ ì—´ë ¤ ìˆëŠ” Overlay ì—…ë°ì´íŠ¸

						// ê°€ê²Œ ì´ë¦„ì„ ê²€ìƒ‰ ì…ë ¥ í•„ë“œì— ì„¤ì •
						searchInput.value = store.stoName; // í´ë¦­í•œ ë§ˆì»¤ì˜ ê°€ê²Œ ì´ë¦„

						// 'ìì„¸íˆ ë³´ê¸°' ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€
						const viewDetailsButton = document.getElementById("viewDetailsButton");
						viewDetailsButton.onclick = function () {
							// ê²€ìƒ‰ì–´ì— ë§ëŠ” ê²°ê³¼ í‘œì‹œ
							const searchTerm = searchInput.value.toLowerCase(); // ì…ë ¥ëœ ê²€ìƒ‰ì–´ ì†Œë¬¸ìë¡œ ë³€í™˜
							resultsDiv.innerHTML = ""; // ì´ì „ ê²€ìƒ‰ ê²°ê³¼ ì´ˆê¸°í™”

							// allStoresì—ì„œ ê²€ìƒ‰ì–´ì— í•´ë‹¹í•˜ëŠ” ê°€ê²Œ ì°¾ê¸°
							const filteredStores = allFindStores.filter(store =>
								store.stoName.toLowerCase().includes(searchTerm)
							);

							displayAllRestaurants(filteredStores, 1); // ì²« í˜ì´ì§€ë¡œ ê²°ê³¼ í‘œì‹œ

							// íŠ¹ì • ìœ„ì¹˜ë¡œ ìŠ¤í¬ë¡¤ (ì˜ˆ: restaurantListì˜ ì²« í•­ëª©)
							const firstItem = $('.restaurant-item').first();
							if (firstItem.length) {
								firstItem.get(0).scrollIntoView({behavior: 'smooth', block: 'start'});
							}

							// í™”ë©´ ë„ˆë¹„ê°€ 768px ë¯¸ë§Œì¼ ë•Œë§Œ ë†’ì´ë¥¼ 80%ë¡œ ì„¤ì •
							if (window.innerWidth < 768) {
								$(".searchWrapper").css("height", "85%"); // ë†’ì´ë¥¼ 80%ë¡œ ì„¤ì •
								$(".hideBtn").data("expanded", true); // ì´ˆê¸° ìƒíƒœ ì„¤ì •
								$('.searchWrapper').animate({
									scrollTop: $('#restaurantList').offset().top - 150
								}, 500); // 500ms ë™ì•ˆ ìŠ¤í¬ë¡¤
							}
						};
					});
				});

			}

			async function fetchStores() {
				const response = await fetch('/load/stores'); // API í˜¸ì¶œ
				const allStores = await response.json(); // JSON ë°ì´í„°ë¡œ ë³€í™˜
				displayStoresOnMap(allStores); // ê°€ì ¸ì˜¨ ê°€ê²Œ ì •ë³´ë¥¼ ì§€ë„ì— í‘œì‹œí•˜ëŠ” í•¨ìˆ˜ í˜¸ì¶œ
			}

			//ê²€ìƒ‰ê¸°ëŠ¥
			let allFindStores = []; // ì „ì²´ ê°€ê²Œ ë°ì´í„°ë¥¼ ì €ì¥í•  ë°°ì—´

			// API í˜¸ì¶œí•˜ì—¬ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
			async function loadStores() {
				try {
					const response = await fetch('/load/stores'); // API í˜¸ì¶œ
					allFindStores = await response.json(); // JSON ë°ì´í„°ë¡œ ë³€í™˜
				} catch (error) {
					console.error("Error fetching stores: ", error);
				}
			}

			// ê²€ìƒ‰ ì…ë ¥ í•„ë“œì™€ ê²°ê³¼ë¥¼ í‘œì‹œí•  ìš”ì†Œ ê°€ì ¸ì˜¤ê¸°
			const searchInput = document.getElementById("searchInput");
			const resultsDiv = document.getElementById("restaurantList");

			// ê²€ìƒ‰ ì´ë²¤íŠ¸ ì¶”ê°€
			searchInput.addEventListener("input", function () {
				const searchTerm = searchInput.value.toLowerCase(); // ì…ë ¥ëœ ê²€ìƒ‰ì–´ ì†Œë¬¸ìë¡œ ë³€í™˜
				resultsDiv.innerHTML = ""; // ì´ì „ ê²€ìƒ‰ ê²°ê³¼ ì´ˆê¸°í™”
				// allStoresì—ì„œ ê²€ìƒ‰ì–´ì— í•´ë‹¹í•˜ëŠ” ê°€ê²Œ ì°¾ê¸°
				const filteredStores = allFindStores.filter(store =>
					store.stoName.toLowerCase().includes(searchTerm)
				);

				displayAllRestaurants(filteredStores, 1); // ì²« í˜ì´ì§€ë¡œ ê²°ê³¼ í‘œì‹œ
				// ê²°ê³¼ í‘œì‹œ

			});
			loadStores()

			let city, district;

			$('#city').change(function () {
				city = $(this).val();
				const districtSelect = $('#district');

				districtSelect.empty(); // ê¸°ì¡´ ì˜µì…˜ ì œê±°
				if (city) {
					districtSelect.append('<option value="">êµ¬ ì„ íƒ</option>');
					// Object.keys()ë¥¼ ì‚¬ìš©í•˜ì—¬ êµ¬ì—­ ì´ë¦„ì„ ê°€ì ¸ì˜´
					Object.keys(districts[city].districts).forEach(function (district) {
						districtSelect.append(`<option value="${district}">${district}</option>`);
					});
					districtSelect.prop('disabled', false); // êµ¬ ì„ íƒ ê°€ëŠ¥
				} else {
					districtSelect.append('<option value="">ì‹œ/ë„ë¥¼ ì„ íƒí•˜ì„¸ìš”</option>');
					districtSelect.prop('disabled', true); // êµ¬ ì„ íƒ ë¶ˆê°€ëŠ¥
				}
			});

			$('#district').change(function () {
				const district = $(this).val();

				if (city && district) {
					fetchRestaurants(city, district);
					loadAllStores(city, district);
				}
			});


			// ì‚¬ìš©ìì˜ ìœ„ì¹˜ë¥¼ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜
			function getUserLocation() {
				if (navigator.geolocation) {
					navigator.geolocation.getCurrentPosition(function (position) {
						const lat = position.coords.latitude;
						const lng = position.coords.longitude;
						fetchRestaurantsByLocation(lat, lng); // ì‚¬ìš©ì ìœ„ì¹˜ë¡œ ì‹ë‹¹ ì •ë³´ ìš”ì²­
					}, function () {
						alert("ìœ„ì¹˜ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
					});
				} else {
					alert("ì´ ë¸Œë¼ìš°ì €ëŠ” Geolocationì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
				}
			}

			// ì‚¬ìš©ì ìœ„ì¹˜ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì‹ë‹¹ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜
			function fetchRestaurantsByLocation(lat, lng) {
				const radius = 5000; // 5km ë°˜ê²½
				const apiUrl = `https://dapi.kakao.com/v2/local/search/keyword.json?query=ë¹„ê±´&category_group_code=FD6&x=${lng}&y=${lat}&radius=${radius}&size=15`;
				$.ajax({
					url: apiUrl,
					type: 'GET',
					headers: {
						Authorization: 'KakaoAK 79b293f9f7248b594b68090c70db6c6f' // ì¹´ì¹´ì˜¤ REST API í‚¤ ì…ë ¥
					},
					success: function (data) {
						allRestaurants = data.documents; // ì‹ë‹¹ ì •ë³´ë¥¼ ì €ì¥
						allRestaurants.forEach(restaurant => {
							const addressParts = restaurant.address_name.split(' '); // ì£¼ì†Œë¥¼ ê³µë°±ìœ¼ë¡œ ë¶„í• 
							const region = addressParts.slice(0, 1).join(' '); // ì²« ë²ˆì§¸ ë¶€ë¶„ (ì˜ˆ: ê²½ê¸°ë„)
							const district = addressParts.slice(1, 2).join(' '); // ë‘ ë²ˆì§¸ ë¶€ë¶„ (ì˜ˆ: ìˆ˜ì›ì‹œ)
							displayRestaurants(allRestaurants, region, district); // ê° ì‹ë‹¹ ë¦¬ìŠ¤íŠ¸ í‘œì‹œ
						});
					},
					error: function (error) {
						console.error("Error fetching data: ", error);
						alert("ì‹ë‹¹ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë° ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
					}
				});
			}



			$(".getUserLocationBtn").on("click", function () {
				if (confirm("í˜„ì¬ ìœ„ì¹˜ë¡œ ì´ë™í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
					loadNearbyStores();
				}
			})


		});

		let allRestaurants = []; // ëª¨ë“  ì‹ë‹¹ ì •ë³´ë¥¼ ì €ì¥í•  ë°°ì—´
		let currentPage = 1; // í˜„ì¬ í˜ì´ì§€

		function fetchRestaurants(city, district) {
			// ìƒˆë¡œìš´ ì§€ì—­ì„ ì„ íƒí•  ë•Œ allRestaurantsë¥¼ ì´ˆê¸°í™”
			allRestaurants = []; // ë°°ì—´ ì´ˆê¸°í™”
			currentPage = 1; // í˜ì´ì§€ ì´ˆê¸°í™”

			const coords = districts[city].districts[district].coords;
			const lat = coords.lat; // ìœ„ë„
			const lng = coords.lng; // ê²½ë„
			const radius = 5000; // 2km ë°˜ê²½
			const apiUrl = `https://dapi.kakao.com/v2/local/search/keyword.json?query=ë¹„ê±´&category_group_code=FD6&x=${lng}&y=${lat}&radius=${radius}&size=15`;

			function fetchPage(page) {
				$.ajax({
					url: `${apiUrl}&page=${page}`, // í˜ì´ì§€ ë²ˆí˜¸ ì¶”ê°€
					type: 'GET',
					headers: {
						Authorization: 'KakaoAK 79b293f9f7248b594b68090c70db6c6f' // ì¹´ì¹´ì˜¤ REST API í‚¤ ì…ë ¥
					},
					success: function (data) {
						allRestaurants = allRestaurants.concat(data.documents); // í˜„ì¬ í˜ì´ì§€ì˜ ì‹ë‹¹ ì •ë³´ë¥¼ ì¶”ê°€

						if (data.meta.is_end) {
							displayRestaurants(allRestaurants, city, district);

						} else {
							fetchPage(page + 1); // ë‹¤ìŒ í˜ì´ì§€ê°€ ìˆìœ¼ë©´ ê³„ì†í•´ì„œ ê°€ì ¸ì˜´
						}
					},
					error: function (error) {
						console.error("Error fetching data: ", error);
						alert("ì‹ë‹¹ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë° ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
					}
				});
			}

			fetchPage(1); // ì²« í˜ì´ì§€ë¶€í„° ì‹œì‘
		}



		// ëœë¤ ë°°ì—´ ìƒì„± (ê°ê° 20ê°œ í•­ëª©)
		const stoTitles = [
			'ì¹œí™˜ê²½ ê±´ê°• ì¹´í˜', 'ë¹„ê±´ ë ˆìŠ¤í† ë‘', 'ìì—°ì£¼ì˜ ìš”ë¦¬', 'ì±„ì‹ ì „ë¬¸ì ', 'ìœ ê¸°ë† ì±„ì‹ë‹¹',
			'ë¹„ê±´ ë²„ê±°ìƒµ', 'ì±„ì‹ ë·”í˜', 'ë¹„ê±´ ë””ì €íŠ¸ ì¹´í˜', 'ë¡œì»¬ ì¬ë£Œ ë¹„ê±´ ì‹ë‹¹', 'ë¹„ê±´ í”¼ì í•˜ìš°ìŠ¤',
			'ë¹„ê±´ ìŠ¤ì‹œ ë°”', 'ë¹„ê±´ ìƒŒë“œìœ„ì¹˜ ìŠ¤í† ì–´', 'ë¹„ê±´ ë¹„ë¹”ë°¥ ì „ë¬¸ì ', 'ë¬´ì²¨ê°€ ê±´ê°•ì‹ë‹¹', 'ì±„ì‹ ë²„ì„¯ì§‘',
			'ë¹„ê±´ íƒ€ì½” í•˜ìš°ìŠ¤', 'ì±„ì†Œì™€ ì½© ì‹ë‹¹', 'ë¹„ê±´ ìŠ¤ë¬´ë”” ì¹´í˜', 'ì§€ì†ê°€ëŠ¥ ì‹ë‹¨ ì „ë¬¸ì ', 'ë¹„ê±´ ë„ì‹œë½ ê°€ê²Œ'
		];

		const stoContents = [
			'ê±´ê°•í•œ ì‹ë‹¨ì„ ì œê³µí•©ë‹ˆë‹¤.', 'ë‹¤ì–‘í•œ ì±„ì‹ ìš”ë¦¬ë¥¼ ë§›ë³´ì„¸ìš”.', 'ë¹„ê±´ ë””ì €íŠ¸ê°€ ìœ ëª…í•œ ê³³ì…ë‹ˆë‹¤.',
			'ìœ ê¸°ë† ì¬ë£Œë§Œ ì‚¬ìš©í•©ë‹ˆë‹¤.', 'í™˜ê²½ ì¹œí™”ì ì¸ ê°€ê²Œì…ë‹ˆë‹¤.', 'ë¹„ê±´ ë²„ê±°ë¥¼ ì¦ê¸¸ ìˆ˜ ìˆëŠ” ê³³ì…ë‹ˆë‹¤.',
			'ë§¤ì¼ ì‹ ì„ í•œ ì±„ì†Œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.', 'ê¸€ë£¨í… í”„ë¦¬ ì˜µì…˜ë„ ìˆìŠµë‹ˆë‹¤.', 'ë¡œì»¬ ì¬ë£Œë¥¼ ì‚¬ìš©í•œ ë©”ë‰´ë¥¼ ì„ ë³´ì…ë‹ˆë‹¤.',
			'ê°€ì¡±ê³¼ í•¨ê»˜ ì¦ê¸¸ ìˆ˜ ìˆëŠ” ë¹„ê±´ ì‹ë‹¹ì…ë‹ˆë‹¤.', 'ì±„ì‹ì˜ ë§¤ë ¥ì„ ëŠë‚„ ìˆ˜ ìˆëŠ” ê³³ì…ë‹ˆë‹¤.', 'ë¹„ê±´ ì™€í”Œì„ ì œê³µí•©ë‹ˆë‹¤.',
			'ìƒ‰ë‹¤ë¥¸ ë¹„ê±´ ìš”ë¦¬ë¥¼ ë§Œë‚  ìˆ˜ ìˆìŠµë‹ˆë‹¤.', 'ë¹„ê±´ í”¼í¬ë‹‰ ì„¸íŠ¸ê°€ ìˆìŠµë‹ˆë‹¤.', 'ì±„ì‹ë§Œìœ¼ë¡œë„ ë“ ë“ í•œ í•œ ë¼ë¥¼ ì œê³µí•©ë‹ˆë‹¤.',
			'ì•„ì´ë“¤ì„ ìœ„í•œ ë¹„ê±´ ë©”ë‰´ë„ ì¤€ë¹„ë˜ì–´ ìˆìŠµë‹ˆë‹¤.', 'í•´ì™¸ ë¹„ê±´ ìš”ë¦¬ë¥¼ ì„ ë³´ì´ëŠ” ê³³ì…ë‹ˆë‹¤.', 'ì£¼ë§ ë¸ŒëŸ°ì¹˜ê°€ ì¸ê¸°ì…ë‹ˆë‹¤.',
			'ë¹„ê±´ ì†ŒìŠ¤ì™€ ë“œë ˆì‹±ì„ ë§Œë‚  ìˆ˜ ìˆìŠµë‹ˆë‹¤.', 'ë¹„ê±´ ì „ë¬¸ ìš”ë¦¬ì‚¬ë“¤ì´ ì¤€ë¹„í•œ ì‹ë‹¹ì…ë‹ˆë‹¤.'
		];

		const stoImages = [
			'/imgs/map/image1.jpg', '/imgs/map/image2.jpg', '/imgs/map/image3.jpg',
			'/imgs/map/image4.jpg', '/imgs/map/image5.jpg', '/imgs/map/image6.jpg',
			'/imgs/map/image7.jpg', '/imgs/map/image8.jpg', '/imgs/map/image9.jpg',
			'/imgs/map/image10.jpg', '/imgs/map/image11.jpg', '/imgs/map/image12.jpg',
			'/imgs/map/image13.jpg', '/imgs/map/image14.jpg', '/imgs/map/image15.jpg',
			'/imgs/map/image16.jpg', '/imgs/map/image17.jpg', '/imgs/map/image18.jpg',
			'/imgs/map/image19.jpg', '/imgs/map/image20.jpg'
		];

		const stoOperatingHours = [
			'10:00 - 22:00', '11:00 - 21:00', '09:00 - 20:00', '12:00 - 23:00', '08:00 - 18:00',
			'10:00 - 21:00', '11:30 - 22:30', '07:00 - 19:00', '10:00 - 20:00', '09:00 - 22:00',
			'08:30 - 19:30', '09:00 - 21:00', '12:00 - 21:00', '11:00 - 20:00', '09:30 - 22:00',
			'10:00 - 20:30', '07:00 - 18:00', '10:00 - 23:00', '08:00 - 20:00', '09:00 - 19:00'
		];

		const stoClosedDays = [
			'ë§¤ì£¼ ì›”ìš”ì¼ íœ´ë¬´', 'ì²«ì§¸ ì£¼ í™”ìš”ì¼ íœ´ë¬´', 'ë§¤ì£¼ ìˆ˜ìš”ì¼ íœ´ë¬´', 'ê³µíœ´ì¼ íœ´ë¬´', 'ë§¤ì£¼ ê¸ˆìš”ì¼ íœ´ë¬´',
			'ë‘˜ì§¸, ë„·ì§¸ ì£¼ ì¼ìš”ì¼ íœ´ë¬´', 'ë§¤ì›” ë§ˆì§€ë§‰ ì£¼ í† ìš”ì¼ íœ´ë¬´', 'ì—°ì¤‘ë¬´íœ´', 'ë§¤ì£¼ í† ìš”ì¼ íœ´ë¬´', 'ë‘˜ì§¸ ì£¼ ëª©ìš”ì¼ íœ´ë¬´',
			'ë§¤ì£¼ ëª©ìš”ì¼ íœ´ë¬´', 'ë§¤ì›” ë‘˜ì§¸ ì£¼ ìˆ˜ìš”ì¼ íœ´ë¬´', 'ì…‹ì§¸ ì£¼ ì¼ìš”ì¼ íœ´ë¬´', 'ê³µíœ´ì¼ ì „ë‚  íœ´ë¬´', 'ë§¤ë‹¬ ì²«ì§¸ ì£¼ ì›”ìš”ì¼ íœ´ë¬´',
			'ê³µíœ´ì¼ ê°œì¥', 'ì£¼ë§ê³¼ ê³µíœ´ì¼ ì—°ì¥ ì˜ì—…', 'ì²«ì§¸, ì…‹ì§¸ ì£¼ ì›”ìš”ì¼ íœ´ë¬´', 'ë¹„ì˜¤ëŠ” ë‚  íœ´ë¬´', 'ì—¬ë¦„ íœ´ê°€ì²  íœ´ë¬´'
		];

		const stoRecommendedMenus = [
			'ë¹„ê±´ ë²„ê±°', 'í† ë§ˆí†  íŒŒìŠ¤íƒ€', 'ì•„ë³´ì¹´ë„ ìƒëŸ¬ë“œ', 'êµ¬ìš´ ì±„ì†Œ í”Œë˜í„°', 'ë¹„ê±´ í”¼ì',
			'ë Œí‹¸ì½© ìŠ¤í”„', 'ê·¸ë¦° ìŠ¤ë¬´ë””', 'ë¹„ê±´ ì´ˆì½œë¦¿ ì¼€ì´í¬', 'ìœ ê¸°ë† í˜„ë¯¸ë°¥', 'ë¹„ê±´ ë¼ìëƒ',
			'ë¹„ê±´ íƒ€ì½”', 'ì–‘ìƒì¶” ë©', 'ë¹„ê±´ ì´ˆë°¥', 'ì±„ì†Œ ë®ë°¥', 'ë¹„ê±´ ë¼ë©´',
			'ì½”ì½”ë„› ì¹´ë ˆ', 'ë‘ë¶€ ìƒëŸ¬ë“œ', 'ê³¼ì¼ í”Œë˜í„°', 'ë¹„ê±´ ì¹˜ì¦ˆ ì¼€ì´í¬', 'ë¹„ê±´ íŒŒë‹ˆë‹ˆ'
		];

		const stoParkingInfos = [
			'ì£¼ì°¨ ê°€ëŠ¥', 'ì£¼ì°¨ ë¶ˆê°€', 'ì¸ê·¼ ê³µìš© ì£¼ì°¨ì¥ ì´ìš©', 'ê°€ê²Œ ì• ë¬´ë£Œ ì£¼ì°¨', 'ë°œë › íŒŒí‚¹ ì„œë¹„ìŠ¤ ì œê³µ',
			'ê°€ê²Œ ë’¤ìª½ ì£¼ì°¨ì¥', 'ì§€í•˜ ì£¼ì°¨ì¥', 'ì¸ê·¼ ìœ ë£Œ ì£¼ì°¨ì¥ ì´ìš©', 'ì£¼ì°¨ ê³µê°„ í˜‘ì†Œ', 'ì£¼ì°¨ ì§€ì› ì—†ìŒ',
			'ì£¼ì°¨ êµ¬ì—­ ì•ˆë‚´í‘œì§€ ìˆìŒ', 'ì£¼ì°¨ì¥ ìˆìŒ', 'ì£¼ì°¨ê°€ í˜¼ì¡í•  ìˆ˜ ìˆìŒ', 'ì£¼ë§ì—ë§Œ ì£¼ì°¨ ê°€ëŠ¥', 'ê°€ê²Œ ì• ì£¼ì°¨ ê¸ˆì§€',
			'ìì „ê±° ì£¼ì°¨ ê°€ëŠ¥', 'ì „ê¸°ì°¨ ì¶©ì „ ì£¼ì°¨ ê°€ëŠ¥', '1ì‹œê°„ ë¬´ë£Œ ì£¼ì°¨', 'ì£¼ì°¨ ê³µê°„ ë„‰ë„‰í•¨', 'ì €ë… ì‹œê°„ ì£¼ì°¨ ê¸ˆì§€'
		];

		const stoVegetarianType = [
			'ë¹„ê±´', 'í”„ë£¨í…Œë¦¬ì–¸', 'ë½í†  ë² ì§€í…Œë¦¬ì–¸', 'ì˜¤ë³´ ë² ì§€í…Œë¦¬ì–¸', 'ë½í†  ì˜¤ë³´ ë² ì§€í…Œë¦¬ì–¸', 'í˜ìŠ¤ì½” ë² ì§€í…Œë¦¬ì–¸',
			'í´ë¡œ ë² ì§€í…Œë¦¬ì–¸', 'í”Œë ‰ì‹œí…Œë¦¬ì–¸'
		]

		// ëœë¤ ì„ íƒ í•¨ìˆ˜
		function getRandomItem(arr) {
			return arr[Math.floor(Math.random() * arr.length)];
		}

		async function displayRestaurants(restaurants, city, district) {
			const restaurantList = $('#restaurantList');

			for (const restaurant of restaurants) {
				const placeName = restaurant.place_name;
				const address = restaurant.road_address_name || restaurant.address_name;
				const phoneNumber = restaurant.phone || 'ì „í™”ë²ˆí˜¸ ì—†ìŒ';
				const category = restaurant.category_name || 'ì¹´í…Œê³ ë¦¬ ì—†ìŒ';
				const lat = restaurant.y; // ìœ„ë„
				const lng = restaurant.x; // ê²½ë„
				const uniqueId = restaurant.id; // ì¹´ì¹´ì˜¤ë§µ APIì—ì„œ ì œê³µí•˜ëŠ” ê³ ìœ  ID




				// ëœë¤í•œ ê°’ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„° ì±„ìš°ê¸°
				const storeData = {
					stoName: placeName,
					stoTitle: getRandomItem(stoTitles),
					stoContent: getRandomItem(stoContents),
					stoCategory: category,
					stoRegionProvince: city,
					stoRegionCity: district,
					viewCount: 0,
					recommendationCount: 0,
					stoContact: phoneNumber,
					stoAddress: address,
					stoImage: getRandomItem(stoImages),
					stoOperatingHours: getRandomItem(stoOperatingHours),
					stoClosedDays: getRandomItem(stoClosedDays),
					stoRecommendedMenu: getRandomItem(stoRecommendedMenus),
					stoParkingInfo: getRandomItem(stoParkingInfos),
					stoLatitude: lat,
					stoLongitude: lng,
					stoVegetarianType: getRandomItem(stoVegetarianType),
					createdAt: new Date(),
					updatedAt: new Date(),
					isOpen: true,
					kakaoStoreId: uniqueId
				};

				// ê³ ìœ  ID ì¡´ì¬ ì—¬ë¶€ ì²´í¬
				// ì´ ì½”ë“œëŠ” ë°ì´í„°ë² ì´ìŠ¤ ì‚½ì… í›„ ê¼­ ë“¤ì–´ê°€ì•¼í•¨, ìˆìœ¼ë©´ ì½”ë“œ ì‚½ì… ì•ˆëŒ
				const exists = await checkIfExists(uniqueId);
				if (exists) {
					continue; // ì¤‘ë³µëœ ê²½ìš° ë‹¤ìŒ ë ˆìŠ¤í† ë‘ìœ¼ë¡œ ë„˜ì–´ê°
				}

				// APIë¥¼ í†µí•´ ë°ì´í„° ì €ì¥
				await saveStoreData(storeData);

				// ì¼ì • ì‹œê°„ ëŒ€ê¸° (API í˜¸ì¶œ ê°„ ê°„ê²© ìœ ì§€)
				await new Promise(resolve => setTimeout(resolve, 100));
			}
		}

		//ë°ì´í„° ì €ì¥í•˜ëŠ” í•¨ìˆ˜
		async function saveStoreData(storeData) {
			try {
				const response = await fetch('http://localhost:8080/load/store/save', {
					method: 'POST',
					headers: {
						'Content-Type': 'application/json',
					},
					body: JSON.stringify(storeData),
				});

				if (!response.ok) {
					throw new Error('Failed to save store data');
				}

				const data = await response.json();
				console.log('Store data saved successfully:', data);
			} catch (error) {
				console.error('Error saving store data:', error);
			}
		}
		// ê³ ìœ  ID ì¡´ì¬ ì—¬ë¶€ ì²´í¬ í•¨ìˆ˜ (ì˜ˆì‹œ)
		async function checkIfExists(uniqueId) {
			const response = await fetch(`http://localhost:8080/load/store/save/${uniqueId}`);
			return response.ok; // ì¡´ì¬í•˜ë©´ true ë°˜í™˜
		}


		// ì§€ë„ í‘œì‹œ í•¨ìˆ˜
		function loadNearbyStores() {
			const restaurantList = $('#restaurantList');
			restaurantList.empty(); // ê¸°ì¡´ ë¦¬ìŠ¤íŠ¸ ì œê±°
			// ì‚¬ìš©ìì˜ í˜„ì¬ ìœ„ì¹˜ ê°€ì ¸ì˜¤ê¸°
			navigator.geolocation.getCurrentPosition(position => {
				const {latitude, longitude} = position.coords;

				fetch('/load/store')
					.then(response => {
						if (!response.ok) {
							throw new Error('Network response was not ok');
						}
						return response.json();
					})
					.then(stores => {
						// ì‚¬ìš©ìì˜ ìœ„ì¹˜ ê·¼ì²˜ ê°€ê²Œ í•„í„°ë§ (ì˜ˆ: 5km ì´ë‚´)
						const nearbyStores = stores.filter(store => {

							const distance = calculateDistance(latitude, longitude, store.stoLatitude, store.stoLongitude);
							return distance <= 5; // 5km ì´ë‚´
						});
						displayAllRestaurants(nearbyStores, 1); // ì²« í˜ì´ì§€ í‘œì‹œ

						// ì²« ë²ˆì§¸ ì‹ë‹¹ì— ëŒ€í•´ ì§€ë„ ì´ˆê¸°í™”
						if (nearbyStores.length > 0) {
							initMap(nearbyStores[0].stoLatitude, nearbyStores[0].stoLongitude, nearbyStores[0].stoName);
						}
					})
					.catch(error => console.error('Error fetching stores:', error));
			}, () => {
				console.error('Unable to retrieve location.');
			});
		}

		function loadAllStores(city, district) {
			const restaurantList = $('#restaurantList');
			restaurantList.empty(); // ê¸°ì¡´ ë¦¬ìŠ¤íŠ¸ ì œê±°
			fetch('/load/store')
				.then(response => response.json())
				.then(stores => {
					const filteredStores = stores.filter(store => {
						return store.stoRegionProvince === city && store.stoRegionCity === district;
					});
					displayAllRestaurants(filteredStores, 1); // ì²« í˜ì´ì§€ í‘œì‹œ
				})
				.catch(error => console.error('Error fetching stores:', error));
		}

		function displayAllRestaurants(filteredStores, currentPage) {
			fetch('/load/getUserId') // ì„œë²„ì˜ ì—”ë“œí¬ì¸íŠ¸ë¡œ ìš”ì²­
				.then(response => {
					if (!response.ok) {
						throw new Error('ë„¤íŠ¸ì›Œí¬ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
					}
					return response.json();
				})
				.then(data => {
					const userId = data.userId; // ì„œë²„ì—ì„œ ë°›ì€ UserId
					const restaurantList = $('#restaurantList');
					const itemsPerPage = 5; // í˜ì´ì§€ë‹¹ í•­ëª© ìˆ˜
					const startIndex = (currentPage - 1) * itemsPerPage;
					const endIndex = startIndex + itemsPerPage;
					const paginatedRestaurants = filteredStores.slice(startIndex, endIndex);
					restaurantList.empty(); // ê¸°ì¡´ ë¦¬ìŠ¤íŠ¸ ì œê±°
					if (paginatedRestaurants.length === 0) {
						restaurantList.append('<div>ì‹ë‹¹ì´ ì—†ìŠµë‹ˆë‹¤.</div>');
						return;
					}

					paginatedRestaurants.forEach((store, index) => {
						const {
							stoId,
							stoName,
							stoTitle,
							stoContent,
							stoCategory,
							viewCount,
							recommendationCount,
							stoContact,
							stoAddress,
							stoImage,
							stoOperatingHours,
							stoClosedDays,
							stoRecommendedMenu,
							stoParkingInfo,
							stoLatitude,
							stoLongitude,
							stoVegetarianType,
							stoRegionProvince,
							stoRegionCity,
							kakaoStoreId,
							storeReviews,
							favoriteStores
						} = store;

						const isOpen = checkIfOpen(stoOperatingHours); // ì—¬ê¸°ì„œ isOpen ê°’ì„ ì„¤ì •

						function checkIfOpen(operatingHours) {
							const [openTime, closeTime] = operatingHours.split(' - ');
							const currentTime = new Date();
							const currentHours = currentTime.getHours();
							const currentMinutes = currentTime.getMinutes();

							const [openHours, openMinutes] = openTime.split(':').map(Number);
							const [closeHours, closeMinutes] = closeTime.split(':').map(Number);

							const currentTotalMinutes = currentHours * 60 + currentMinutes;
							const openTotalMinutes = openHours * 60 + openMinutes;
							const closeTotalMinutes = closeHours * 60 + closeMinutes;

							return currentTotalMinutes >= openTotalMinutes && currentTotalMinutes < closeTotalMinutes;
						}

						const storeItem = $(`
                    <div class="restaurant-item" id='restaurant-item' data-lat="${stoLatitude}" data-lng="${stoLongitude}">
                        <p class='solo'>${stoName} - ${stoTitle} </p>
						<div class="cardIcons ">
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#808080" class="bi bi-eye" viewBox="0 0 16 16">
						<path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z" />
						<path d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0" />
						</svg>
						<span class='text-secondary'>${viewCount}</span>
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#808080" class="bi bi-chat" viewBox="0 0 16 16">
						<path d="M2.678 11.894a1 1 0 0 1 .287.801 11 11 0 0 1-.398 2c1.395-.323 2.247-.697 2.634-.893a1 1 0 0 1 .71-.074A8 8 0 0 0 8 14c3.996 0 7-2.807 7-6s-3.004-6-7-6-7 2.808-7 6c0 1.468.617 2.83 1.678 3.894m-.493 3.905a22 22 0 0 1-.713.129c-.2.032-.352-.176-.273-.362a10 10 0 0 0 .244-.637l.003-.01c.248-.72.45-1.548.524-2.319C.743 11.37 0 9.76 0 8c0-3.866 3.582-7 8-7s8 3.134 8 7-3.582 7-8 7a9 9 0 0 1-2.347-.306c-.52.263-1.639.742-3.468 1.105" />
						</svg>
						<span class='text-secondary'>${storeReviews.length}</span> 
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#808080" class="bi bi-heart" viewBox="0 0 16 16">
						<path d="m8 2.748-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143q.09.083.176.171a3 3 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15" />
						</svg>
						<span class='text-secondary'>${favoriteStores.length}</span>
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#808080" class="bi bi-star" viewBox="0 0 16 16">
						  <path d="M2.866 14.85c-.078.444.36.791.746.593l4.39-2.256 4.389 2.256c.386.198.824-.149.746-.592l-.83-4.73 3.522-3.356c.33-.314.16-.888-.282-.95l-4.898-.696L8.465.792a.513.513 0 0 0-.927 0L5.354 5.12l-4.898.696c-.441.062-.612.636-.283.95l3.523 3.356-.83 4.73zm4.905-2.767-3.686 1.894.694-3.957a.56.56 0 0 0-.163-.505L1.71 6.745l4.052-.576a.53.53 0 0 0 .393-.288L8 2.223l1.847 3.658a.53.53 0 0 0 .393.288l4.052.575-2.906 2.77a.56.56 0 0 0-.163.506l.694 3.957-3.686-1.894a.5.5 0 0 0-.461 0z"/>
						</svg> 
						<span class='text-secondary'>${recommendationCount}</span>			
						</div>
                        <img src="${stoImage}" alt="${stoName}" class='img-fluid w-100 mb-3'><br>
						<p><strong>ì „í™”ë²ˆí˜¸:</strong> ${stoContact}</p>
						<p><strong>ì£¼ì†Œ:</strong> ${stoAddress}</p>
						<p><strong>ìš´ì˜ì‹œê°„:</strong> ${stoOperatingHours} (${isOpen ? 'ì˜ì—…ì¤‘' : 'ì˜ì—…ì¢…ë£Œ'})</p>
						<p><strong>íœ´ë¬´ì¼:</strong> ${stoClosedDays}</p>
						<p><strong>ì¶”ì²œ ë©”ë‰´:</strong> ${stoRecommendedMenu}</p>
						<p><strong>ì£¼ì°¨ ì •ë³´:</strong> ${stoParkingInfo}</p>
						<p><strong>ì±„ì‹ ì¢…ë¥˜:</strong> ${stoVegetarianType}</p>
						<small><strong>ì¹´í…Œê³ ë¦¬:</strong> ${stoCategory}</small>
                        <a href="http://localhost:8080/load/place/${stoId}" class="my-2 btn btn-info">ìì„¸íˆë³´ê¸°</a>
						<span class='mx-2 btn btn-warning' onclick="addFavorite('${userId}', ${stoId})">ì°œğŸ‘</span>
						<span class='btn btn-success w-100' onclick="showReservationForm('${userId}', ${stoId}, '${stoOperatingHours}', event)">ì˜ˆì•½ğŸ—“ï¸</span>
						<div id="reservationForm_${stoId}" style="display: none;" onclick="event.stopPropagation();">
						    <h5>ì˜ˆì•½ ì‹œê°„ ì„ íƒ</h5>
							<div class="form-group">
							    <label for="reservationDate_${stoId}">ì˜ˆì•½ ë‚ ì§œ ì„ íƒ:</label>
							    <div class="input-group">
							        <input type="text" class="form-control" id="reservationDate_${stoId}" placeholder="YYYY-MM-DD" required>
							        <div class="input-group-append">
							            <span class="input-group-text">
							                <i class="fa fa-calendar" aria-hidden="true"></i>
							            </span>
							        </div>
							    </div>
							
							</div>
							<div class="form-group my-2">
							    <label for="reservationTime_${stoId}">ì˜ˆì•½ ì‹œê°„ ì„ íƒ:</label>
							    <select id="reservationTime_${stoId}" class="form-control">
							        
							    </select>
							</div>
						    <button class="btn btn-primary" onclick="makeReservation()">í™•ì¸</button>
						    <button class="btn btn-secondary" onclick="hideReservationForm()">ì·¨ì†Œ</button>
						</div>
                    </div>
                `);

						restaurantList.append(storeItem);

						storeItem.on('click', function () {
							// í´ë¦­í•œ í•­ëª©ì´ ì´ë¯¸ í™•ì¥ëœ ìƒíƒœì¸ì§€ í™•ì¸
							if ($(this).hasClass('expanded')) {
								$(this).removeClass('expanded'); // í´ë˜ìŠ¤ ì œê±°
							} else {
								$('.restaurant-item').removeClass('expanded'); // ëª¨ë“  í•­ëª© í´ë˜ìŠ¤ ì œê±°
								$(this).addClass('expanded'); // í´ë¦­í•œ í•­ëª©ì— í´ë˜ìŠ¤ ì¶”ê°€
								// í´ë¦­í•œ í•­ëª©ìœ¼ë¡œ ìŠ¤í¬ë¡¤
								$('.searchWrapper').animate({
									scrollTop: $(this).offset().top - 150
								}, 500); // 500ms ë™ì•ˆ ìŠ¤í¬ë¡¤
							}

							initMap(stoLatitude, stoLongitude, stoName); // ì§€ë„ ì´ˆê¸°í™”
							$(`#${store.stoId}`).datetimepicker(); // ê³ ìœ  IDë¡œ ì´ˆê¸°í™”
						});


					});

					// ê¸°ë³¸ì ìœ¼ë¡œ ì²« ë²ˆì§¸ í•­ëª© í™•ì¥
					if (paginatedRestaurants.length > 0) {
						const firstItem = $('.restaurant-item').first();
						initMap(firstItem.data('lat'), firstItem.data('lng'), firstItem.find('.solo').text()); // ì´ˆê¸° ì§€ë„ ì„¤ì •
					}

					if (paginatedRestaurants.length == 1) {
						const firstItem = $('.restaurant-item').first();
						firstItem.addClass('expanded');


					}
					setupPagination(filteredStores.length, itemsPerPage, filteredStores); // í˜ì´ì§€ë„¤ì´ì…˜ ì„¤ì •
				})
				.catch(error => console.error('Error:', error));
		}


		//í˜ì´ì§€ë„¤ì´ì…˜ í•¨ìˆ˜
		function setupPagination(totalItems, itemsPerPage, filteredStores) {
			const pagination = $('#pagination');
			pagination.empty(); // ê¸°ì¡´ í˜ì´ì§€ë„¤ì´ì…˜ ì œê±°
			const totalPages = Math.ceil(totalItems / itemsPerPage); // ì´ í˜ì´ì§€ ìˆ˜
			const maxButtons = 3; // í‘œì‹œí•  ìµœëŒ€ ë²„íŠ¼ ìˆ˜
			let startPage, endPage;

			// ì‹œì‘ í˜ì´ì§€ì™€ ë í˜ì´ì§€ ê³„ì‚°
			if (totalPages <= maxButtons) {
				startPage = 1;
				endPage = totalPages;
			} else {
				startPage = Math.max(1, currentPage - Math.floor(maxButtons / 2));
				endPage = Math.min(totalPages, startPage + maxButtons - 1);

				// ì‹œì‘ í˜ì´ì§€ê°€ 1ë³´ë‹¤ ì‘ì€ ê²½ìš° ì¡°ì •
				if (startPage === 1) {
					endPage = Math.min(maxButtons, totalPages);
				}
				// ë í˜ì´ì§€ê°€ ì´ í˜ì´ì§€ ìˆ˜ë³´ë‹¤ í° ê²½ìš° ì¡°ì •
				if (endPage === totalPages) {
					startPage = Math.max(1, totalPages - maxButtons + 1);
				}
			}

			// ì´ì „ ë²„íŠ¼ ì¶”ê°€
			const prevButton = $('<button>').html('<i class="fas fa-chevron-left"></i>').on('click', function () {
				if (currentPage > 1) {
					currentPage--; // í˜ì´ì§€ ê°ì†Œ
					setupPagination(totalItems, itemsPerPage, filteredStores); // í˜ì´ì§€ë„¤ì´ì…˜ ì—…ë°ì´íŠ¸
					displayAllRestaurants(filteredStores, currentPage); // í•´ë‹¹ í˜ì´ì§€ì˜ ì‹ë‹¹ ë¦¬ìŠ¤íŠ¸ í‘œì‹œ
				}
			});
			// ì´ì „ ë²„íŠ¼ ë¹„í™œì„±í™” ì—¬ë¶€ ì„¤ì •
			if (currentPage === 1) {
				prevButton.prop('disabled', true).addClass('disabled'); // ë¹„í™œì„±í™” ìƒíƒœ
			}
			pagination.append(prevButton);

			// í˜ì´ì§€ ë²„íŠ¼ ì¶”ê°€
			for (let i = startPage; i <= endPage; i++) {
				const pageButton = $('<button>').text(i).on('click', function () {
					currentPage = i; // í´ë¦­í•œ í˜ì´ì§€ë¡œ ì´ë™
					displayAllRestaurants(filteredStores, currentPage); // í•´ë‹¹ í˜ì´ì§€ì˜ ì‹ë‹¹ ë¦¬ìŠ¤íŠ¸ í‘œì‹œ
					setupPagination(totalItems, itemsPerPage, filteredStores); // í˜ì´ì§€ë„¤ì´ì…˜ ì—…ë°ì´íŠ¸
				});

				if (i === currentPage) {
					pageButton.addClass('active');
				}

				pagination.append(pageButton);
			}

			// ë‹¤ìŒ ë²„íŠ¼ ì¶”ê°€
			const nextButton = $('<button>').html('<i class="fas fa-chevron-right"></i>').on('click', function () {
				if (currentPage < totalPages) {
					currentPage++; // í˜ì´ì§€ ì¦ê°€
					setupPagination(totalItems, itemsPerPage, filteredStores); // í˜ì´ì§€ë„¤ì´ì…˜ ì—…ë°ì´íŠ¸
					displayAllRestaurants(filteredStores, currentPage); // í•´ë‹¹ í˜ì´ì§€ì˜ ì‹ë‹¹ ë¦¬ìŠ¤íŠ¸ í‘œì‹œ
				}
			});
			// ë‹¤ìŒ ë²„íŠ¼ ë¹„í™œì„±í™” ì—¬ë¶€ ì„¤ì •
			if (currentPage === totalPages) {
				nextButton.prop('disabled', true).addClass('disabled'); // ë¹„í™œì„±í™” ìƒíƒœ
			}
			pagination.append(nextButton);
		}


		// ê±°ë¦¬ ê³„ì‚° í•¨ìˆ˜
		function calculateDistance(lat1, lon1, lat2, lon2) {
			const R = 6371; // ì§€êµ¬ ë°˜ì§€ë¦„ (í‚¬ë¡œë¯¸í„°)
			const dLat = (lat2 - lat1) * Math.PI / 180;
			const dLon = (lon2 - lon1) * Math.PI / 180;
			const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +
				Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
				Math.sin(dLon / 2) * Math.sin(dLon / 2);
			const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
			return R * c; // ê±°ë¦¬ ë°˜í™˜ (í‚¬ë¡œë¯¸í„°)
		}



		function initMap(lat, lng, placeName) {
			const mapContainer = document.getElementById('map');
			const mapOption = {
				center: new kakao.maps.LatLng(lat, lng),
				level: 3 // ì´ˆê¸° í™•ëŒ€ ìˆ˜ì¤€
			};
			const map = new kakao.maps.Map(mapContainer, mapOption);

			// ë§ˆì»¤ ì¶”ê°€
			const markerPosition = new kakao.maps.LatLng(lat, lng);
			const marker = new kakao.maps.Marker({
				position: markerPosition,
				title: placeName
			});
			marker.setMap(map);

			// Custom Overlay ì¶”ê°€
			const customOverlay = new kakao.maps.CustomOverlay({
				content: `
					<div class='infowindowBox'>
						<span class='closeBtn' onclick='this.parentElement.parentElement.style.display="none"'>âœ–</span>
						<div style='font-size: 16px; color: #333;'>${placeName}</div>
					</div>`,
				position: markerPosition // Overlay ìœ„ì¹˜ ì„¤ì •
			});
			customOverlay.setMap(map);

			// ì‚¬ìš©ì ì •ì˜ í™•ëŒ€/ì¶•ì†Œ ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
			document.getElementById('zoomIn').addEventListener('click', function () {
				map.setLevel(map.getLevel() - 1); // í™•ëŒ€
			});

			document.getElementById('zoomOut').addEventListener('click', function () {
				map.setLevel(map.getLevel() + 1); // ì¶•ì†Œ
			});
		}

		//ì°œí•˜ê¸° í•¨ìˆ˜
		function addFavorite(memberId, stoId) {
			console.log('memberId:', memberId); // ë””ë²„ê¹…ìš© ì¶œë ¥
			console.log('stoId:', stoId); // ë””ë²„ê¹…ìš© ì¶œë ¥
			fetch(`/store/favorite/add?memberId=${memberId}&stoId=${stoId}`, { // ì„œë²„ì˜ API ì—”ë“œí¬ì¸íŠ¸
				method: 'POST',
				headers: {
					'Content-Type': 'application/json',
				},
				body: JSON.stringify({memberId: memberId, stoId: stoId})
			})
				.then(response => {
					if (response.ok) {
						alert('ì°œí•˜ê¸°ì— ì„±ê³µí–ˆìŠµë‹ˆë‹¤!');
					} else {
						return response.text().then(text => {
							if (text === "ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”") {
								alert(text);
								// ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
								window.location.href = 'http://localhost:8080/member/login'; // ë¡œê·¸ì¸ í˜ì´ì§€ URLë¡œ ìˆ˜ì •
							} else {
								alert(text); // ë‹¤ë¥¸ ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ
							}
						});
					}
				})
				.catch(error => {
					console.error('Error:', error);
					alert('ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
				});
		}


		//ì˜ˆì•½ ì‹œê°„ í•¨ìˆ˜
		function populateReservationTimes(operatingHours) {
			const timeSelect = document.getElementById(`reservationTime_${window.currentStoId}`);
			timeSelect.innerHTML = ''; // ê¸°ì¡´ ì˜µì…˜ ì‚­ì œ

			const [start, end] = operatingHours.split(' - '); // ì‹œì‘ ì‹œê°„ê³¼ ì¢…ë£Œ ì‹œê°„ ë¶„ë¦¬
			const [startHour, startMinute] = start.split(':').map(Number);
			const [endHour, endMinute] = end.split(':').map(Number);
			const interval = 30; // ê°„ê²© (ë¶„ ë‹¨ìœ„)

			const now = new Date(); // í˜„ì¬ ì‹œê°„
			const currentHour = now.getHours();
			const currentMinute = now.getMinutes();

			// ì¢…ë£Œ ì‹œê°„ì—ì„œ 30ë¶„ ì „ ê³„ì‚°
			let adjustedEndHour = endHour;
			let adjustedEndMinute = endMinute - 30;

			if (adjustedEndMinute < 0) {
				adjustedEndHour -= 1;
				adjustedEndMinute += 60; // 60ë¶„ìœ¼ë¡œ ë³´ì •
			}

			// ì¢…ë£Œ ì‹œê°„ì´ 0ì‹œê°€ ë˜ì§€ ì•Šë„ë¡ ì²˜ë¦¬
			if (adjustedEndHour < startHour) {
				adjustedEndHour = startHour;
				adjustedEndMinute = 0;
			}

			let hasAvailableTime = false; // ì˜ˆì•½ ê°€ëŠ¥í•œ ì‹œê°„ì´ ìˆëŠ”ì§€ ì—¬ë¶€

			for (let hour = startHour; hour <= adjustedEndHour; hour++) {
				for (let minute = (hour === startHour ? startMinute : 0); minute < 60; minute += interval) {
					if (hour === adjustedEndHour && minute > adjustedEndMinute) break; // ì¡°ì •ëœ ì¢…ë£Œ ì‹œê°„ ì´ˆê³¼ ì‹œ ì¤‘ë‹¨

					// í˜„ì¬ ì‹œê°„ë³´ë‹¤ ì´ì „ì˜ ì˜µì…˜ ì œê±°
					if (hour < currentHour || (hour === currentHour && minute <= currentMinute)) {
						continue; // ì´ì „ ì‹œê°„ì€ ê±´ë„ˆëœ€
					}

					hasAvailableTime = true; // ì˜ˆì•½ ê°€ëŠ¥í•œ ì‹œê°„ì´ ìˆìŒì„ í‘œì‹œ

					const formattedHour = hour.toString().padStart(2, '0');
					const formattedMinute = minute.toString().padStart(2, '0');
					const optionValue = `${formattedHour}:${formattedMinute}`;
					const option = document.createElement('option');
					option.value = optionValue;
					option.textContent = optionValue;
					timeSelect.appendChild(option);
				}
			}

			// ì˜ˆì•½ ê°€ëŠ¥í•œ ì‹œê°„ì´ ì—†ì„ ê²½ìš° placeholderì²˜ëŸ¼ ë³´ì´ë„ë¡ ì„¤ì •
			if (!hasAvailableTime) {
				const placeholderOption = document.createElement('option');
				placeholderOption.value = '';
				placeholderOption.textContent = 'ì˜ˆì•½ ê°€ëŠ¥í•œ ì‹œê°„ì´ ì—†ìŠµë‹ˆë‹¤';
				placeholderOption.disabled = true; // ì„ íƒí•  ìˆ˜ ì—†ë„ë¡ ë¹„í™œì„±í™”
				placeholderOption.selected = true; // ê¸°ë³¸ ì„ íƒ ìƒíƒœ
				timeSelect.appendChild(placeholderOption);
			}
		}

		// ì˜ˆì•½ í¼ì´ ì—´ë¦´ ë•Œ ì‹œê°„ ì˜µì…˜ì„ ì±„ìš°ë„ë¡ ë³€ê²½
		function showReservationForm(userId, stoId, operatingHours, event) {
			event.stopPropagation()
			document.getElementById(`reservationForm_${stoId}`).style.display = 'block';
			window.currentUserId = userId;
			window.currentStoId = stoId;
			populateReservationTimes(operatingHours); // ì‹œê°„ ì˜µì…˜ ì±„ìš°ê¸°



			// Bootstrap Datepicker ì´ˆê¸°í™” (í•œê¸€ ì„¤ì •)
			$(`#reservationDate_${stoId}`).datepicker({ // ìˆ˜ì •
				format: 'yyyy-mm-dd',
				autoclose: true,
				todayHighlight: true,
				language: "kr",
				startDate: new Date() // ì˜¤ëŠ˜ ë‚ ì§œë¶€í„° ì„ íƒ ê°€ëŠ¥
			}).datepicker('setDate', new Date()); // ì˜¤ëŠ˜ ë‚ ì§œë¡œ ì´ˆê¸°í™”
		}


		function makeReservation() {
			const reservationDate = $(`#reservationDate_${window.currentStoId}`).val();
			const reservationTime = $(`#reservationTime_${window.currentStoId}`).val();
			const userId = window.currentUserId;
			if (userId == 'ë¡œê·¸ì¸ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.') {
				window.location.href = 'http://localhost:8080/member/login'; // ë¡œê·¸ì¸ í˜ì´ì§€ URLë¡œ ìˆ˜ì •
			}

			const stoId = window.currentStoId;

			const reservationData = {
				userId: userId,
				stoId: stoId,
				reservationTime: `${reservationDate} ${reservationTime}`,
			};

			fetch('/store/reservations', {
				method: 'POST',
				headers: {
					'Content-Type': 'application/json',
				},
				body: JSON.stringify(reservationData),
			})
				.then(response => {
					if (!response.ok) {
						return response.json().then(err => {
							throw new Error(err.message || 'ì˜ˆì•½ ìš”ì²­ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
						});
					}
					return response.json();
				})
				.then(data => {
					alert('ì˜ˆì•½ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!');
					hideReservationForm();  // ì˜ˆì•½ ì™„ë£Œ í›„ í¼ ìˆ¨ê¸°ê¸°
				})
				.catch(error => {
					alert(error.message);
				});
		}

		function hideReservationForm() {
			document.getElementById(`reservationForm_${window.currentStoId}`).style.display = 'none'; // ìˆ˜ì •
		}

		// ë‚ ì§œ ë° ì‹œê°„ ì„ íƒê¸° í† ê¸€ í•¨ìˆ˜
		function toggleDateTimePicker() {
			const picker = $(`#datetimepicker_${window.currentStoId}`);

			// DateTimePickerê°€ ì´ˆê¸°í™”ë˜ì—ˆëŠ”ì§€ í™•ì¸
			const dateTimePicker = picker.data("DateTimePicker");
			if (dateTimePicker) {
				if (dateTimePicker.date()) {
					dateTimePicker.date(null); // ë‹«ê¸°
				} else {
					dateTimePicker.show(); // ì—´ê¸°
				}
			} else {
				console.error("DateTimePickerê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
				alert("ë‚ ì§œ ë° ì‹œê°„ ì„ íƒê¸°ê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
			}
		}


	</script>
</div>

</html>